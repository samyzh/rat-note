<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue-cli自定义实现 | 写作认知体系</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/rat-summ/img/favicon.ico">
    <link rel="manifest" href="/rat-summ/manifest.json">
    <script charset="utf-8" src="/rat-summ/js/readmore.js"></script>
    <meta name="description" content="最近在学习 vue-cli 的源码，获益良多。为了让自己理解得更加深刻，我决定模仿它造一个轮子，争取尽可能多的实现原有的功能。">
    <meta name="image" content="https://my.samyz.cn/_image/02.vue-cli自定义实现/21528a60b4b9470a9cf583bcc9edcbd2~tplv-k3u1fbpfcp-watermark.png">
    <meta name="twitter:title" content="vue-cli自定义实现">
    <meta name="twitter:description" content="最近在学习 vue-cli 的源码，获益良多。为了让自己理解得更加深刻，我决定模仿它造一个轮子，争取尽可能多的实现原有的功能。">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://my.samyz.cn/_image/02.vue-cli自定义实现/21528a60b4b9470a9cf583bcc9edcbd2~tplv-k3u1fbpfcp-watermark.png">
    <meta name="twitter:url" content="https://my.samyz.cn/%E3%80%8A%E6%8A%80%E8%83%BD%E8%AE%B0%E5%BD%95%E3%80%8B/04.vue/05.cli/02.vue-cli%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%9E%E7%8E%B0.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="vue-cli自定义实现">
    <meta property="og:description" content="最近在学习 vue-cli 的源码，获益良多。为了让自己理解得更加深刻，我决定模仿它造一个轮子，争取尽可能多的实现原有的功能。">
    <meta property="og:image" content="https://my.samyz.cn/_image/02.vue-cli自定义实现/21528a60b4b9470a9cf583bcc9edcbd2~tplv-k3u1fbpfcp-watermark.png">
    <meta property="og:url" content="https://my.samyz.cn/%E3%80%8A%E6%8A%80%E8%83%BD%E8%AE%B0%E5%BD%95%E3%80%8B/04.vue/05.cli/02.vue-cli%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%9E%E7%8E%B0.html">
    <meta property="og:site_name" content="samyzh">
    <meta property="article:published_time" content="2021-02-24T23:22:45.000Z">
    <meta itemprop="name" content="vue-cli自定义实现">
    <meta itemprop="description" content="最近在学习 vue-cli 的源码，获益良多。为了让自己理解得更加深刻，我决定模仿它造一个轮子，争取尽可能多的实现原有的功能。">
    <meta itemprop="image" content="https://my.samyz.cn/_image/02.vue-cli自定义实现/21528a60b4b9470a9cf583bcc9edcbd2~tplv-k3u1fbpfcp-watermark.png">
    <meta name="keywords" content="vuepress,theme,doc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/rat-summ/assets/css/0.styles.ea37c4a1.css" as="style"><link rel="preload" href="/rat-summ/assets/js/app.d4fe6087.js" as="script"><link rel="preload" href="/rat-summ/assets/js/2.d4f28c34.js" as="script"><link rel="preload" href="/rat-summ/assets/js/16.4204b333.js" as="script"><link rel="preload" href="/rat-summ/assets/js/96.e18c84a7.js" as="script"><link rel="prefetch" href="/rat-summ/assets/js/10.e0df923c.js"><link rel="prefetch" href="/rat-summ/assets/js/100.25be9ef0.js"><link rel="prefetch" href="/rat-summ/assets/js/101.c84290a3.js"><link rel="prefetch" href="/rat-summ/assets/js/102.d6b4302a.js"><link rel="prefetch" href="/rat-summ/assets/js/103.f33cc793.js"><link rel="prefetch" href="/rat-summ/assets/js/104.83f8c1df.js"><link rel="prefetch" href="/rat-summ/assets/js/105.2e81b140.js"><link rel="prefetch" href="/rat-summ/assets/js/106.f6622f2a.js"><link rel="prefetch" href="/rat-summ/assets/js/107.65c08c5c.js"><link rel="prefetch" href="/rat-summ/assets/js/108.12bdc92a.js"><link rel="prefetch" href="/rat-summ/assets/js/109.c31f0f64.js"><link rel="prefetch" href="/rat-summ/assets/js/11.761c5f87.js"><link rel="prefetch" href="/rat-summ/assets/js/110.66080278.js"><link rel="prefetch" href="/rat-summ/assets/js/111.c1032fe7.js"><link rel="prefetch" href="/rat-summ/assets/js/112.7ad7365d.js"><link rel="prefetch" href="/rat-summ/assets/js/113.5e71cf1b.js"><link rel="prefetch" href="/rat-summ/assets/js/114.0a3bd36a.js"><link rel="prefetch" href="/rat-summ/assets/js/115.53363169.js"><link rel="prefetch" href="/rat-summ/assets/js/116.96a79a63.js"><link rel="prefetch" href="/rat-summ/assets/js/117.42ebbdaa.js"><link rel="prefetch" href="/rat-summ/assets/js/118.7e52785e.js"><link rel="prefetch" href="/rat-summ/assets/js/119.231e32e9.js"><link rel="prefetch" href="/rat-summ/assets/js/12.9bb2c2e0.js"><link rel="prefetch" href="/rat-summ/assets/js/120.6026cc40.js"><link rel="prefetch" href="/rat-summ/assets/js/121.0a2eda80.js"><link rel="prefetch" href="/rat-summ/assets/js/122.6615a459.js"><link rel="prefetch" href="/rat-summ/assets/js/123.96b17f7b.js"><link rel="prefetch" href="/rat-summ/assets/js/124.a9cffdc3.js"><link rel="prefetch" href="/rat-summ/assets/js/125.3aedfc5f.js"><link rel="prefetch" href="/rat-summ/assets/js/126.e1dad155.js"><link rel="prefetch" href="/rat-summ/assets/js/127.24df170f.js"><link rel="prefetch" href="/rat-summ/assets/js/128.f8bf85e3.js"><link rel="prefetch" href="/rat-summ/assets/js/129.3ebe7248.js"><link rel="prefetch" href="/rat-summ/assets/js/13.acbd01a0.js"><link rel="prefetch" href="/rat-summ/assets/js/130.8a2b0a0e.js"><link rel="prefetch" href="/rat-summ/assets/js/131.bde5325c.js"><link rel="prefetch" href="/rat-summ/assets/js/132.2ddb7e3c.js"><link rel="prefetch" href="/rat-summ/assets/js/133.1ebc2bc1.js"><link rel="prefetch" href="/rat-summ/assets/js/134.c45d4cea.js"><link rel="prefetch" href="/rat-summ/assets/js/135.ac17b33e.js"><link rel="prefetch" href="/rat-summ/assets/js/136.d83882c9.js"><link rel="prefetch" href="/rat-summ/assets/js/137.fd7e6efe.js"><link rel="prefetch" href="/rat-summ/assets/js/138.22a3c306.js"><link rel="prefetch" href="/rat-summ/assets/js/139.dfdd6379.js"><link rel="prefetch" href="/rat-summ/assets/js/14.f5de695b.js"><link rel="prefetch" href="/rat-summ/assets/js/140.700d9f69.js"><link rel="prefetch" href="/rat-summ/assets/js/141.e3b0221e.js"><link rel="prefetch" href="/rat-summ/assets/js/142.5012f6d5.js"><link rel="prefetch" href="/rat-summ/assets/js/143.c2dc2dce.js"><link rel="prefetch" href="/rat-summ/assets/js/144.3e4b75ec.js"><link rel="prefetch" href="/rat-summ/assets/js/145.13a8b399.js"><link rel="prefetch" href="/rat-summ/assets/js/146.70f5ac4b.js"><link rel="prefetch" href="/rat-summ/assets/js/147.0d5d58cd.js"><link rel="prefetch" href="/rat-summ/assets/js/148.aacf63f5.js"><link rel="prefetch" href="/rat-summ/assets/js/149.895e4fd8.js"><link rel="prefetch" href="/rat-summ/assets/js/15.fa4defba.js"><link rel="prefetch" href="/rat-summ/assets/js/150.4ae6eeac.js"><link rel="prefetch" href="/rat-summ/assets/js/151.f72a57b1.js"><link rel="prefetch" href="/rat-summ/assets/js/152.faa08a26.js"><link rel="prefetch" href="/rat-summ/assets/js/153.d874a8f1.js"><link rel="prefetch" href="/rat-summ/assets/js/154.35894c2e.js"><link rel="prefetch" href="/rat-summ/assets/js/155.df75c456.js"><link rel="prefetch" href="/rat-summ/assets/js/156.f67ffe52.js"><link rel="prefetch" href="/rat-summ/assets/js/157.6ba1aa39.js"><link rel="prefetch" href="/rat-summ/assets/js/158.f4e33392.js"><link rel="prefetch" href="/rat-summ/assets/js/159.0c1bf178.js"><link rel="prefetch" href="/rat-summ/assets/js/160.b95cb57a.js"><link rel="prefetch" href="/rat-summ/assets/js/161.241b8b97.js"><link rel="prefetch" href="/rat-summ/assets/js/162.572fef13.js"><link rel="prefetch" href="/rat-summ/assets/js/163.1974ca32.js"><link rel="prefetch" href="/rat-summ/assets/js/164.abafb067.js"><link rel="prefetch" href="/rat-summ/assets/js/165.6cbad524.js"><link rel="prefetch" href="/rat-summ/assets/js/166.1543416f.js"><link rel="prefetch" href="/rat-summ/assets/js/167.f4fe7f3b.js"><link rel="prefetch" href="/rat-summ/assets/js/168.22ec85bc.js"><link rel="prefetch" href="/rat-summ/assets/js/169.9429ac16.js"><link rel="prefetch" href="/rat-summ/assets/js/17.d8b1fa06.js"><link rel="prefetch" href="/rat-summ/assets/js/170.5d21c313.js"><link rel="prefetch" href="/rat-summ/assets/js/171.fb97db6c.js"><link rel="prefetch" href="/rat-summ/assets/js/172.e77cdea4.js"><link rel="prefetch" href="/rat-summ/assets/js/173.c51a2877.js"><link rel="prefetch" href="/rat-summ/assets/js/174.b92338fb.js"><link rel="prefetch" href="/rat-summ/assets/js/175.21a40216.js"><link rel="prefetch" href="/rat-summ/assets/js/176.92cb0a5d.js"><link rel="prefetch" href="/rat-summ/assets/js/177.448bbbcc.js"><link rel="prefetch" href="/rat-summ/assets/js/178.a8821cec.js"><link rel="prefetch" href="/rat-summ/assets/js/179.a76ff9d0.js"><link rel="prefetch" href="/rat-summ/assets/js/18.d4717354.js"><link rel="prefetch" href="/rat-summ/assets/js/180.cb15b175.js"><link rel="prefetch" href="/rat-summ/assets/js/181.9ce44a33.js"><link rel="prefetch" href="/rat-summ/assets/js/182.87bdc2cd.js"><link rel="prefetch" href="/rat-summ/assets/js/183.7f53f4e2.js"><link rel="prefetch" href="/rat-summ/assets/js/184.a02c4c97.js"><link rel="prefetch" href="/rat-summ/assets/js/185.8f8339bc.js"><link rel="prefetch" href="/rat-summ/assets/js/186.7bb1d8fa.js"><link rel="prefetch" href="/rat-summ/assets/js/187.8cde5359.js"><link rel="prefetch" href="/rat-summ/assets/js/188.d0ce7168.js"><link rel="prefetch" href="/rat-summ/assets/js/189.e2779cc5.js"><link rel="prefetch" href="/rat-summ/assets/js/19.57c26288.js"><link rel="prefetch" href="/rat-summ/assets/js/190.e5aca8fb.js"><link rel="prefetch" href="/rat-summ/assets/js/191.cd004740.js"><link rel="prefetch" href="/rat-summ/assets/js/192.4f12a689.js"><link rel="prefetch" href="/rat-summ/assets/js/193.3142b310.js"><link rel="prefetch" href="/rat-summ/assets/js/194.da48a9af.js"><link rel="prefetch" href="/rat-summ/assets/js/195.1d836ffb.js"><link rel="prefetch" href="/rat-summ/assets/js/196.5ef7989a.js"><link rel="prefetch" href="/rat-summ/assets/js/197.95fca86a.js"><link rel="prefetch" href="/rat-summ/assets/js/198.a350b2a0.js"><link rel="prefetch" href="/rat-summ/assets/js/199.670ec80f.js"><link rel="prefetch" href="/rat-summ/assets/js/20.8859bdb4.js"><link rel="prefetch" href="/rat-summ/assets/js/200.5b2ec953.js"><link rel="prefetch" href="/rat-summ/assets/js/201.71e57c08.js"><link rel="prefetch" href="/rat-summ/assets/js/202.36fb732f.js"><link rel="prefetch" href="/rat-summ/assets/js/203.31661a65.js"><link rel="prefetch" href="/rat-summ/assets/js/204.9a60d991.js"><link rel="prefetch" href="/rat-summ/assets/js/205.0a0e0108.js"><link rel="prefetch" href="/rat-summ/assets/js/206.e9f0cb13.js"><link rel="prefetch" href="/rat-summ/assets/js/207.e76128c0.js"><link rel="prefetch" href="/rat-summ/assets/js/208.d4468295.js"><link rel="prefetch" href="/rat-summ/assets/js/209.364bffe5.js"><link rel="prefetch" href="/rat-summ/assets/js/21.13568c31.js"><link rel="prefetch" href="/rat-summ/assets/js/210.d7156634.js"><link rel="prefetch" href="/rat-summ/assets/js/211.3ef79707.js"><link rel="prefetch" href="/rat-summ/assets/js/212.025e8ca6.js"><link rel="prefetch" href="/rat-summ/assets/js/213.b9cf70b2.js"><link rel="prefetch" href="/rat-summ/assets/js/214.2aa87a38.js"><link rel="prefetch" href="/rat-summ/assets/js/215.587bd0f9.js"><link rel="prefetch" href="/rat-summ/assets/js/216.6bc7dd67.js"><link rel="prefetch" href="/rat-summ/assets/js/217.fd366d2d.js"><link rel="prefetch" href="/rat-summ/assets/js/218.c454be54.js"><link rel="prefetch" href="/rat-summ/assets/js/219.55c4ee1e.js"><link rel="prefetch" href="/rat-summ/assets/js/22.fe073a6b.js"><link rel="prefetch" href="/rat-summ/assets/js/220.a20bb37d.js"><link rel="prefetch" href="/rat-summ/assets/js/221.0da9bd73.js"><link rel="prefetch" href="/rat-summ/assets/js/222.acab6078.js"><link rel="prefetch" href="/rat-summ/assets/js/223.6e6eb503.js"><link rel="prefetch" href="/rat-summ/assets/js/224.e02e0947.js"><link rel="prefetch" href="/rat-summ/assets/js/225.77f856bc.js"><link rel="prefetch" href="/rat-summ/assets/js/226.ba95f314.js"><link rel="prefetch" href="/rat-summ/assets/js/227.48c32f3e.js"><link rel="prefetch" href="/rat-summ/assets/js/228.3afb056f.js"><link rel="prefetch" href="/rat-summ/assets/js/229.011c3b58.js"><link rel="prefetch" href="/rat-summ/assets/js/23.685f93c4.js"><link rel="prefetch" href="/rat-summ/assets/js/230.2a7d274b.js"><link rel="prefetch" href="/rat-summ/assets/js/231.0e58515a.js"><link rel="prefetch" href="/rat-summ/assets/js/232.12682cc5.js"><link rel="prefetch" href="/rat-summ/assets/js/233.4d9449cf.js"><link rel="prefetch" href="/rat-summ/assets/js/234.7e22495b.js"><link rel="prefetch" href="/rat-summ/assets/js/235.7d0e1160.js"><link rel="prefetch" href="/rat-summ/assets/js/236.b8eff948.js"><link rel="prefetch" href="/rat-summ/assets/js/237.9c084eab.js"><link rel="prefetch" href="/rat-summ/assets/js/238.a7b0885e.js"><link rel="prefetch" href="/rat-summ/assets/js/239.b6b058e4.js"><link rel="prefetch" href="/rat-summ/assets/js/24.fd7da72d.js"><link rel="prefetch" href="/rat-summ/assets/js/240.83d5e90d.js"><link rel="prefetch" href="/rat-summ/assets/js/241.a9666c7c.js"><link rel="prefetch" href="/rat-summ/assets/js/242.2f4a2d6f.js"><link rel="prefetch" href="/rat-summ/assets/js/243.31e04101.js"><link rel="prefetch" href="/rat-summ/assets/js/244.5a7bfc53.js"><link rel="prefetch" href="/rat-summ/assets/js/245.0a05d740.js"><link rel="prefetch" href="/rat-summ/assets/js/246.86375b20.js"><link rel="prefetch" href="/rat-summ/assets/js/247.e822fb19.js"><link rel="prefetch" href="/rat-summ/assets/js/248.57fd0c43.js"><link rel="prefetch" href="/rat-summ/assets/js/249.f855a118.js"><link rel="prefetch" href="/rat-summ/assets/js/25.8d7a4d93.js"><link rel="prefetch" href="/rat-summ/assets/js/250.b188c59d.js"><link rel="prefetch" href="/rat-summ/assets/js/251.7e4e84a2.js"><link rel="prefetch" href="/rat-summ/assets/js/252.2aafb779.js"><link rel="prefetch" href="/rat-summ/assets/js/253.b6ed4d32.js"><link rel="prefetch" href="/rat-summ/assets/js/254.ad7e4320.js"><link rel="prefetch" href="/rat-summ/assets/js/255.c3eff825.js"><link rel="prefetch" href="/rat-summ/assets/js/256.9b691409.js"><link rel="prefetch" href="/rat-summ/assets/js/257.f9a58366.js"><link rel="prefetch" href="/rat-summ/assets/js/258.32751d3a.js"><link rel="prefetch" href="/rat-summ/assets/js/259.87d453bf.js"><link rel="prefetch" href="/rat-summ/assets/js/26.ae598e4e.js"><link rel="prefetch" href="/rat-summ/assets/js/260.b1c3731c.js"><link rel="prefetch" href="/rat-summ/assets/js/261.581691bb.js"><link rel="prefetch" href="/rat-summ/assets/js/262.fdbb68aa.js"><link rel="prefetch" href="/rat-summ/assets/js/263.5eac7b08.js"><link rel="prefetch" href="/rat-summ/assets/js/264.3e5ae049.js"><link rel="prefetch" href="/rat-summ/assets/js/265.e560ba1a.js"><link rel="prefetch" href="/rat-summ/assets/js/266.cfb9cf35.js"><link rel="prefetch" href="/rat-summ/assets/js/267.071f13f9.js"><link rel="prefetch" href="/rat-summ/assets/js/268.8bb02241.js"><link rel="prefetch" href="/rat-summ/assets/js/269.e9ccb75e.js"><link rel="prefetch" href="/rat-summ/assets/js/27.62096338.js"><link rel="prefetch" href="/rat-summ/assets/js/270.00c21967.js"><link rel="prefetch" href="/rat-summ/assets/js/271.0ccdfdeb.js"><link rel="prefetch" href="/rat-summ/assets/js/272.9b16e71c.js"><link rel="prefetch" href="/rat-summ/assets/js/273.f21daf40.js"><link rel="prefetch" href="/rat-summ/assets/js/274.398de258.js"><link rel="prefetch" href="/rat-summ/assets/js/275.893610d6.js"><link rel="prefetch" href="/rat-summ/assets/js/276.6bc40456.js"><link rel="prefetch" href="/rat-summ/assets/js/277.055ecccd.js"><link rel="prefetch" href="/rat-summ/assets/js/278.8a5873ba.js"><link rel="prefetch" href="/rat-summ/assets/js/279.503d83fd.js"><link rel="prefetch" href="/rat-summ/assets/js/28.e9261df3.js"><link rel="prefetch" href="/rat-summ/assets/js/280.e9dacfee.js"><link rel="prefetch" href="/rat-summ/assets/js/281.d71b9f89.js"><link rel="prefetch" href="/rat-summ/assets/js/282.287947a4.js"><link rel="prefetch" href="/rat-summ/assets/js/283.ec30bb94.js"><link rel="prefetch" href="/rat-summ/assets/js/284.4456be87.js"><link rel="prefetch" href="/rat-summ/assets/js/285.451b948b.js"><link rel="prefetch" href="/rat-summ/assets/js/286.ac6bf1ef.js"><link rel="prefetch" href="/rat-summ/assets/js/287.c519acda.js"><link rel="prefetch" href="/rat-summ/assets/js/288.e3eaaf40.js"><link rel="prefetch" href="/rat-summ/assets/js/289.35035028.js"><link rel="prefetch" href="/rat-summ/assets/js/29.85b4b0dc.js"><link rel="prefetch" href="/rat-summ/assets/js/290.7af6c2bc.js"><link rel="prefetch" href="/rat-summ/assets/js/291.bdd53ac4.js"><link rel="prefetch" href="/rat-summ/assets/js/292.f5e294cf.js"><link rel="prefetch" href="/rat-summ/assets/js/293.b53f5815.js"><link rel="prefetch" href="/rat-summ/assets/js/294.e5b67d62.js"><link rel="prefetch" href="/rat-summ/assets/js/295.529c4257.js"><link rel="prefetch" href="/rat-summ/assets/js/296.1b0850c4.js"><link rel="prefetch" href="/rat-summ/assets/js/297.5d87f6a8.js"><link rel="prefetch" href="/rat-summ/assets/js/298.4281cee5.js"><link rel="prefetch" href="/rat-summ/assets/js/299.3a3e997c.js"><link rel="prefetch" href="/rat-summ/assets/js/3.30b0215d.js"><link rel="prefetch" href="/rat-summ/assets/js/30.51e6dc93.js"><link rel="prefetch" href="/rat-summ/assets/js/300.443491af.js"><link rel="prefetch" href="/rat-summ/assets/js/301.6627dcf9.js"><link rel="prefetch" href="/rat-summ/assets/js/302.91d574d8.js"><link rel="prefetch" href="/rat-summ/assets/js/303.7016c353.js"><link rel="prefetch" href="/rat-summ/assets/js/304.d550b266.js"><link rel="prefetch" href="/rat-summ/assets/js/305.bfbec795.js"><link rel="prefetch" href="/rat-summ/assets/js/306.abf09935.js"><link rel="prefetch" href="/rat-summ/assets/js/307.b61bee72.js"><link rel="prefetch" href="/rat-summ/assets/js/308.87f4b909.js"><link rel="prefetch" href="/rat-summ/assets/js/309.05bcfef5.js"><link rel="prefetch" href="/rat-summ/assets/js/31.c5cf586c.js"><link rel="prefetch" href="/rat-summ/assets/js/310.31a9cf03.js"><link rel="prefetch" href="/rat-summ/assets/js/311.10af3bf6.js"><link rel="prefetch" href="/rat-summ/assets/js/312.dff06896.js"><link rel="prefetch" href="/rat-summ/assets/js/313.1d6f347b.js"><link rel="prefetch" href="/rat-summ/assets/js/314.25dc4c41.js"><link rel="prefetch" href="/rat-summ/assets/js/315.ffebe23d.js"><link rel="prefetch" href="/rat-summ/assets/js/316.1ea82c7b.js"><link rel="prefetch" href="/rat-summ/assets/js/317.f9f265b8.js"><link rel="prefetch" href="/rat-summ/assets/js/318.157eefdc.js"><link rel="prefetch" href="/rat-summ/assets/js/319.5a9fb5af.js"><link rel="prefetch" href="/rat-summ/assets/js/32.627a4eb6.js"><link rel="prefetch" href="/rat-summ/assets/js/320.37c1c2b9.js"><link rel="prefetch" href="/rat-summ/assets/js/321.e1933383.js"><link rel="prefetch" href="/rat-summ/assets/js/322.0ecd1f30.js"><link rel="prefetch" href="/rat-summ/assets/js/323.471e9f4d.js"><link rel="prefetch" href="/rat-summ/assets/js/324.fbffe746.js"><link rel="prefetch" href="/rat-summ/assets/js/325.4798848a.js"><link rel="prefetch" href="/rat-summ/assets/js/326.fe2830cc.js"><link rel="prefetch" href="/rat-summ/assets/js/327.98bd46ec.js"><link rel="prefetch" href="/rat-summ/assets/js/328.e3b29b8c.js"><link rel="prefetch" href="/rat-summ/assets/js/329.3a1e30b2.js"><link rel="prefetch" href="/rat-summ/assets/js/33.1745c30c.js"><link rel="prefetch" href="/rat-summ/assets/js/330.8a6caeab.js"><link rel="prefetch" href="/rat-summ/assets/js/331.ca734e5b.js"><link rel="prefetch" href="/rat-summ/assets/js/332.bb5c10d5.js"><link rel="prefetch" href="/rat-summ/assets/js/333.130f183d.js"><link rel="prefetch" href="/rat-summ/assets/js/334.502028e8.js"><link rel="prefetch" href="/rat-summ/assets/js/335.0aa30551.js"><link rel="prefetch" href="/rat-summ/assets/js/336.672cab22.js"><link rel="prefetch" href="/rat-summ/assets/js/337.a746a7bc.js"><link rel="prefetch" href="/rat-summ/assets/js/338.baf3f2a0.js"><link rel="prefetch" href="/rat-summ/assets/js/339.ace612b4.js"><link rel="prefetch" href="/rat-summ/assets/js/34.025cb969.js"><link rel="prefetch" href="/rat-summ/assets/js/340.12c28925.js"><link rel="prefetch" href="/rat-summ/assets/js/341.f84edde2.js"><link rel="prefetch" href="/rat-summ/assets/js/342.bd7812a1.js"><link rel="prefetch" href="/rat-summ/assets/js/343.2327936f.js"><link rel="prefetch" href="/rat-summ/assets/js/344.464252a5.js"><link rel="prefetch" href="/rat-summ/assets/js/345.93c67c54.js"><link rel="prefetch" href="/rat-summ/assets/js/346.08d8661c.js"><link rel="prefetch" href="/rat-summ/assets/js/347.4717d6b3.js"><link rel="prefetch" href="/rat-summ/assets/js/348.3abc0680.js"><link rel="prefetch" href="/rat-summ/assets/js/349.ae6c2429.js"><link rel="prefetch" href="/rat-summ/assets/js/35.8a35ddc4.js"><link rel="prefetch" href="/rat-summ/assets/js/350.0ced61f3.js"><link rel="prefetch" href="/rat-summ/assets/js/351.0ee534d4.js"><link rel="prefetch" href="/rat-summ/assets/js/352.76185971.js"><link rel="prefetch" href="/rat-summ/assets/js/353.a827393a.js"><link rel="prefetch" href="/rat-summ/assets/js/354.703e2f43.js"><link rel="prefetch" href="/rat-summ/assets/js/355.1c21cd7e.js"><link rel="prefetch" href="/rat-summ/assets/js/356.f5de7da2.js"><link rel="prefetch" href="/rat-summ/assets/js/357.44f38395.js"><link rel="prefetch" href="/rat-summ/assets/js/358.be391715.js"><link rel="prefetch" href="/rat-summ/assets/js/359.52e7ca03.js"><link rel="prefetch" href="/rat-summ/assets/js/36.ee87ddbc.js"><link rel="prefetch" href="/rat-summ/assets/js/360.2c475c66.js"><link rel="prefetch" href="/rat-summ/assets/js/361.3ca16ee4.js"><link rel="prefetch" href="/rat-summ/assets/js/362.6cbd67ed.js"><link rel="prefetch" href="/rat-summ/assets/js/363.c0c9d592.js"><link rel="prefetch" href="/rat-summ/assets/js/364.6c48ea1e.js"><link rel="prefetch" href="/rat-summ/assets/js/365.669d40d9.js"><link rel="prefetch" href="/rat-summ/assets/js/366.5cdd6960.js"><link rel="prefetch" href="/rat-summ/assets/js/367.5d81330a.js"><link rel="prefetch" href="/rat-summ/assets/js/368.66b4e165.js"><link rel="prefetch" href="/rat-summ/assets/js/369.c356b91b.js"><link rel="prefetch" href="/rat-summ/assets/js/37.05b6dead.js"><link rel="prefetch" href="/rat-summ/assets/js/370.26c815fc.js"><link rel="prefetch" href="/rat-summ/assets/js/371.defff585.js"><link rel="prefetch" href="/rat-summ/assets/js/372.219700c5.js"><link rel="prefetch" href="/rat-summ/assets/js/373.f87f3d8e.js"><link rel="prefetch" href="/rat-summ/assets/js/374.2fd577e9.js"><link rel="prefetch" href="/rat-summ/assets/js/375.3cb1dcfc.js"><link rel="prefetch" href="/rat-summ/assets/js/376.efa84bd2.js"><link rel="prefetch" href="/rat-summ/assets/js/377.52c66352.js"><link rel="prefetch" href="/rat-summ/assets/js/378.ab6f84aa.js"><link rel="prefetch" href="/rat-summ/assets/js/379.431fecfd.js"><link rel="prefetch" href="/rat-summ/assets/js/38.505a98a4.js"><link rel="prefetch" href="/rat-summ/assets/js/380.64869e20.js"><link rel="prefetch" href="/rat-summ/assets/js/381.bc2b123c.js"><link rel="prefetch" href="/rat-summ/assets/js/382.025e42e5.js"><link rel="prefetch" href="/rat-summ/assets/js/383.dec0d986.js"><link rel="prefetch" href="/rat-summ/assets/js/384.abf1ad8c.js"><link rel="prefetch" href="/rat-summ/assets/js/385.6d5c95f3.js"><link rel="prefetch" href="/rat-summ/assets/js/386.d971916b.js"><link rel="prefetch" href="/rat-summ/assets/js/387.36affe3c.js"><link rel="prefetch" href="/rat-summ/assets/js/388.1c6808b0.js"><link rel="prefetch" href="/rat-summ/assets/js/389.06fcd9f7.js"><link rel="prefetch" href="/rat-summ/assets/js/39.48b3dfb2.js"><link rel="prefetch" href="/rat-summ/assets/js/390.6302c8a9.js"><link rel="prefetch" href="/rat-summ/assets/js/391.9983a6dc.js"><link rel="prefetch" href="/rat-summ/assets/js/392.8f58781d.js"><link rel="prefetch" href="/rat-summ/assets/js/393.28ef587e.js"><link rel="prefetch" href="/rat-summ/assets/js/394.a77ab4ba.js"><link rel="prefetch" href="/rat-summ/assets/js/395.8bff5f43.js"><link rel="prefetch" href="/rat-summ/assets/js/396.31e18444.js"><link rel="prefetch" href="/rat-summ/assets/js/397.c12e8b8c.js"><link rel="prefetch" href="/rat-summ/assets/js/398.662fe63c.js"><link rel="prefetch" href="/rat-summ/assets/js/399.0db9725f.js"><link rel="prefetch" href="/rat-summ/assets/js/4.b03183cb.js"><link rel="prefetch" href="/rat-summ/assets/js/40.f000dcac.js"><link rel="prefetch" href="/rat-summ/assets/js/400.f3e95029.js"><link rel="prefetch" href="/rat-summ/assets/js/401.8d2a15bc.js"><link rel="prefetch" href="/rat-summ/assets/js/402.d3baeeb2.js"><link rel="prefetch" href="/rat-summ/assets/js/403.9ac2d5be.js"><link rel="prefetch" href="/rat-summ/assets/js/404.f2e0ac3d.js"><link rel="prefetch" href="/rat-summ/assets/js/405.c0333393.js"><link rel="prefetch" href="/rat-summ/assets/js/406.46d6afb9.js"><link rel="prefetch" href="/rat-summ/assets/js/407.f386a2ca.js"><link rel="prefetch" href="/rat-summ/assets/js/408.722c4018.js"><link rel="prefetch" href="/rat-summ/assets/js/409.7f3f374a.js"><link rel="prefetch" href="/rat-summ/assets/js/41.085c4bfa.js"><link rel="prefetch" href="/rat-summ/assets/js/410.6f7f46cb.js"><link rel="prefetch" href="/rat-summ/assets/js/411.7b6bb623.js"><link rel="prefetch" href="/rat-summ/assets/js/412.1c4e89f9.js"><link rel="prefetch" href="/rat-summ/assets/js/413.f3bd4510.js"><link rel="prefetch" href="/rat-summ/assets/js/414.ecde3b10.js"><link rel="prefetch" href="/rat-summ/assets/js/415.120c8d5e.js"><link rel="prefetch" href="/rat-summ/assets/js/416.b425e441.js"><link rel="prefetch" href="/rat-summ/assets/js/417.10022f9a.js"><link rel="prefetch" href="/rat-summ/assets/js/418.9b45086f.js"><link rel="prefetch" href="/rat-summ/assets/js/42.0a89f95d.js"><link rel="prefetch" href="/rat-summ/assets/js/43.f8bd27f5.js"><link rel="prefetch" href="/rat-summ/assets/js/44.34bbe27f.js"><link rel="prefetch" href="/rat-summ/assets/js/45.3acde343.js"><link rel="prefetch" href="/rat-summ/assets/js/46.62d91520.js"><link rel="prefetch" href="/rat-summ/assets/js/47.28552705.js"><link rel="prefetch" href="/rat-summ/assets/js/48.eb677d27.js"><link rel="prefetch" href="/rat-summ/assets/js/49.2008148b.js"><link rel="prefetch" href="/rat-summ/assets/js/5.55528c74.js"><link rel="prefetch" href="/rat-summ/assets/js/50.74365169.js"><link rel="prefetch" href="/rat-summ/assets/js/51.e3941e56.js"><link rel="prefetch" href="/rat-summ/assets/js/52.bfe9047a.js"><link rel="prefetch" href="/rat-summ/assets/js/53.e5c087bc.js"><link rel="prefetch" href="/rat-summ/assets/js/54.3d49dd74.js"><link rel="prefetch" href="/rat-summ/assets/js/55.fc8b058c.js"><link rel="prefetch" href="/rat-summ/assets/js/56.bd6512b3.js"><link rel="prefetch" href="/rat-summ/assets/js/57.5d51da6c.js"><link rel="prefetch" href="/rat-summ/assets/js/58.efe25a47.js"><link rel="prefetch" href="/rat-summ/assets/js/59.cb9015cb.js"><link rel="prefetch" href="/rat-summ/assets/js/6.ff530d99.js"><link rel="prefetch" href="/rat-summ/assets/js/60.d481bb6f.js"><link rel="prefetch" href="/rat-summ/assets/js/61.5bc85224.js"><link rel="prefetch" href="/rat-summ/assets/js/62.942ab118.js"><link rel="prefetch" href="/rat-summ/assets/js/63.d08359cb.js"><link rel="prefetch" href="/rat-summ/assets/js/64.d2a1069d.js"><link rel="prefetch" href="/rat-summ/assets/js/65.33f5cad9.js"><link rel="prefetch" href="/rat-summ/assets/js/66.738f34a5.js"><link rel="prefetch" href="/rat-summ/assets/js/67.0532cd2d.js"><link rel="prefetch" href="/rat-summ/assets/js/68.7d6ae148.js"><link rel="prefetch" href="/rat-summ/assets/js/69.dfbcd46e.js"><link rel="prefetch" href="/rat-summ/assets/js/7.dcb1dc1c.js"><link rel="prefetch" href="/rat-summ/assets/js/70.12f95662.js"><link rel="prefetch" href="/rat-summ/assets/js/71.738b5cbd.js"><link rel="prefetch" href="/rat-summ/assets/js/72.653ed5de.js"><link rel="prefetch" href="/rat-summ/assets/js/73.8bc69f34.js"><link rel="prefetch" href="/rat-summ/assets/js/74.f4889379.js"><link rel="prefetch" href="/rat-summ/assets/js/75.8530eac4.js"><link rel="prefetch" href="/rat-summ/assets/js/76.b952aea7.js"><link rel="prefetch" href="/rat-summ/assets/js/77.af1f4ad8.js"><link rel="prefetch" href="/rat-summ/assets/js/78.fe4470af.js"><link rel="prefetch" href="/rat-summ/assets/js/79.7539c952.js"><link rel="prefetch" href="/rat-summ/assets/js/8.6a6a21e7.js"><link rel="prefetch" href="/rat-summ/assets/js/80.8e8b4da0.js"><link rel="prefetch" href="/rat-summ/assets/js/81.3439878c.js"><link rel="prefetch" href="/rat-summ/assets/js/82.a9ee8aa8.js"><link rel="prefetch" href="/rat-summ/assets/js/83.70eb0a3e.js"><link rel="prefetch" href="/rat-summ/assets/js/84.179cc8fc.js"><link rel="prefetch" href="/rat-summ/assets/js/85.a6cee10b.js"><link rel="prefetch" href="/rat-summ/assets/js/86.5d3a42c6.js"><link rel="prefetch" href="/rat-summ/assets/js/87.fdae2c61.js"><link rel="prefetch" href="/rat-summ/assets/js/88.3b1a9c05.js"><link rel="prefetch" href="/rat-summ/assets/js/89.cd3cadf5.js"><link rel="prefetch" href="/rat-summ/assets/js/9.abbfe68b.js"><link rel="prefetch" href="/rat-summ/assets/js/90.1c8f120d.js"><link rel="prefetch" href="/rat-summ/assets/js/91.9169e692.js"><link rel="prefetch" href="/rat-summ/assets/js/92.a54885f4.js"><link rel="prefetch" href="/rat-summ/assets/js/93.ad139862.js"><link rel="prefetch" href="/rat-summ/assets/js/94.ea3f584f.js"><link rel="prefetch" href="/rat-summ/assets/js/95.91678324.js"><link rel="prefetch" href="/rat-summ/assets/js/97.3b75200f.js"><link rel="prefetch" href="/rat-summ/assets/js/98.52e4a976.js"><link rel="prefetch" href="/rat-summ/assets/js/99.3bbdf5fe.js">
    <link rel="stylesheet" href="/rat-summ/assets/css/0.styles.ea37c4a1.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rat-summ/" class="home-link router-link-active"><img src="/rat-summ/img/logo.png" alt="写作认知体系" class="logo"> <span class="site-name can-hide">写作认知体系</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rat-summ/" class="nav-link">首页</a></div><div class="nav-item"><a href="/rat-summ/writeRead/" class="nav-link">写作阅读</a></div><div class="nav-item"><a href="/rat-summ/promoteOper/" class="nav-link">推广运营</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="💖职场技能" class="dropdown-title"><a href="/rat-summ/workSkill/" class="link-title">💖职场技能</a> <span class="title" style="display:none;">💖职场技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rat-summ/skill-note/" class="nav-link">技能记录</a></li><li class="dropdown-item"><!----> <a href="/rat-summ/skill-inter/" class="nav-link">面试技巧</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌹快捷入口" class="dropdown-title"><!----> <span class="title" style="display:;">🌹快捷入口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>快捷链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/rat-summ/pages/devLink/" class="nav-link">开发收藏</a></li></ul></li><li class="dropdown-item"><h4>💖体系入口</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-skill" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工作实践体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-summ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  写作认知体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-invest" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投资理财体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/samyzh/rat-summ" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/rat-summ/" class="nav-link">首页</a></div><div class="nav-item"><a href="/rat-summ/writeRead/" class="nav-link">写作阅读</a></div><div class="nav-item"><a href="/rat-summ/promoteOper/" class="nav-link">推广运营</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="💖职场技能" class="dropdown-title"><a href="/rat-summ/workSkill/" class="link-title">💖职场技能</a> <span class="title" style="display:none;">💖职场技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rat-summ/skill-note/" class="nav-link">技能记录</a></li><li class="dropdown-item"><!----> <a href="/rat-summ/skill-inter/" class="nav-link">面试技巧</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌹快捷入口" class="dropdown-title"><!----> <span class="title" style="display:;">🌹快捷入口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>快捷链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/rat-summ/pages/devLink/" class="nav-link">开发收藏</a></li></ul></li><li class="dropdown-item"><h4>💖体系入口</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-skill" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工作实践体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-summ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  写作认知体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-invest" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投资理财体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/samyzh/rat-summ" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>知识体系</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d299c4/" class="sidebar-link">知识体系</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>html&amp;css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/59df57/" class="sidebar-link">html的使用</a></li><li><a href="/rat-summ/pages/bfeb1c/" class="sidebar-link">css的使用</a></li><li><a href="/rat-summ/pages/6f569a/" class="sidebar-link">html居中及常用布局</a></li><li><a href="/rat-summ/pages/75c080/" class="sidebar-link">html移动端适配</a></li><li><a href="/rat-summ/pages/1f3ef7/" class="sidebar-link">CSS和JS动画</a></li><li><a href="/rat-summ/pages/445bb3/" class="sidebar-link">html与js的组合使用</a></li><li><a href="/rat-summ/pages/b50ea5/" class="sidebar-link">前端跨页面通信</a></li><li><a href="/rat-summ/pages/91bfa6/" class="sidebar-link">html跨tab页通信(同源跨域)</a></li><li><a href="/rat-summ/pages/975a2e/" class="sidebar-link">cookie常用操作</a></li><li><a href="/rat-summ/pages/b09bd9/" class="sidebar-link">JS中对URL进行转码与解码</a></li><li><a href="/rat-summ/pages/7f7002/" class="sidebar-link">img标注热点分布</a></li><li><a href="/rat-summ/pages/d3dec5/" class="sidebar-link">html中input输入数字控制</a></li><li><a href="/rat-summ/pages/ac76fc/" class="sidebar-link">textarea的换行与空格问题</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>基础框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/1db8ae/" class="sidebar-link">jquery及zepto的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/2e79cd/" class="sidebar-link">html禁止复制文字</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>浏览器渲染</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7027dc/" class="sidebar-link">浏览器渲染机制</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/80f4c6/" class="sidebar-link">浏览器优化</a></li><li><a href="/rat-summ/pages/b48090/" class="sidebar-link">http相关优化技巧</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/45b059/" class="sidebar-link">js模块化</a></li><li><a href="/rat-summ/pages/77c195/" class="sidebar-link">js分类、比较及数组</a></li><li><a href="/rat-summ/pages/8a1238/" class="sidebar-link">js函数</a></li><li><a href="/rat-summ/pages/803bc1/" class="sidebar-link">js对象、class、proxy及Symbol</a></li><li><a href="/rat-summ/pages/c85153/" class="sidebar-link">es6之变量,扩展,symbol,set,map,proxy,reflect及class</a></li><li><a href="/rat-summ/pages/db6ce7/" class="sidebar-link">es6之module,iterator,promise及es6+</a></li><li><a href="/rat-summ/pages/5c649d/" class="sidebar-link">es6中的proxy的使用</a></li><li><a href="/rat-summ/pages/b8e539/" class="sidebar-link">js异步</a></li><li><a href="/rat-summ/pages/2fa04b/" class="sidebar-link">js事件循环及优化</a></li><li><a href="/rat-summ/pages/730656/" class="sidebar-link">数组常用方法</a></li><li><a href="/rat-summ/pages/35e184/" class="sidebar-link">js中手写常用方法</a></li><li><a href="/rat-summ/pages/c5c2b5/" class="sidebar-link">前端异常的捕获与处理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>网络库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a34b2c/" class="sidebar-link">ajax&amp;axios和fetch对比及其优缺点梳理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>常用库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7349f2/" class="sidebar-link">lodashjs中节流及防抖的实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7afb20/" class="sidebar-link">数字取整问题</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c7cd4e/" class="sidebar-link">node版本及源管理</a></li><li><a href="/rat-summ/pages/24c387/" class="sidebar-link">npm常用命令操作</a></li><li><a href="/rat-summ/pages/b9d467/" class="sidebar-link">npm发布及私服搭建</a></li><li><a href="/rat-summ/pages/b23049/" class="sidebar-link">yarn相关总结</a></li><li><a href="/rat-summ/pages/90e3bb/" class="sidebar-link">verdaccio详细设置</a></li><li><a href="/rat-summ/pages/53158b/" class="sidebar-link">nexus布署私有npm仓库</a></li><li><a href="/rat-summ/pages/cc3405/" class="sidebar-link">npm包管理机制</a></li><li><a href="/rat-summ/pages/68c863/" class="sidebar-link">mac下彻底卸载node和npm</a></li><li><a href="/rat-summ/pages/d4e855/" class="sidebar-link">patch-package修改依赖包</a></li><li><a href="/rat-summ/pages/c886c0/" class="sidebar-link">pnm包管理</a></li><li><a href="/rat-summ/pages/bb9351/" class="sidebar-link">bower包管理</a></li><li><a href="/rat-summ/pages/8a2ca0/" class="sidebar-link">npm-git-bower设置代理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f36b82/" class="sidebar-link">index</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>koa</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/796cbb/" class="sidebar-link">模板引擎ejs</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>egg</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/514ebb/" class="sidebar-link">eggjs中curl请求、HTTP基础及RouteCtrl实战</a></li><li><a href="/rat-summ/pages/39412b/" class="sidebar-link">eggjs中HttpClient网络及Curl的使用</a></li><li><a href="/rat-summ/pages/4738e8/" class="sidebar-link">eggjs中Cookie与Session使用</a></li><li><a href="/rat-summ/pages/47858c/" class="sidebar-link">eggjs中实现RESTfulAPI及Router</a></li><li><a href="/rat-summ/pages/a69e2d/" class="sidebar-link">eggjs中cluster的实现原理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/9b9c71/" class="sidebar-link">vue的使用</a></li><li><a href="/rat-summ/pages/a3a764/" class="sidebar-link">vue相关官方文档记录</a></li><li><a href="/rat-summ/pages/11e30d/" class="sidebar-link">vue手写自定义实现</a></li><li><a href="/rat-summ/pages/8afce1/" class="sidebar-link">vue源码分析和对原理的理解</a></li><li><a href="/rat-summ/pages/41c21e/" class="sidebar-link">vue的源码分析</a></li><li><a href="/rat-summ/pages/6ce810/" class="sidebar-link">vue2、vue3及react的三种Diff算法</a></li><li><a href="/rat-summ/pages/00dd2e/" class="sidebar-link">vue与react的对比及个人思考</a></li><li><a href="/rat-summ/pages/48ad40/" class="sidebar-link">vue组件通信方式及原理分析</a></li><li><a href="/rat-summ/pages/7b620d/" class="sidebar-link">vue组件化</a></li><li><a href="/rat-summ/pages/66b1e4/" class="sidebar-link">vue3新特点</a></li><li><a href="/rat-summ/pages/191c2d/" class="sidebar-link">vue中nextTick实现原理</a></li><li><a href="/rat-summ/pages/vue-pro-pref/" class="sidebar-link">vue项目优化技巧【重点】</a></li><li><a href="/rat-summ/pages/211945/" class="sidebar-link">vue项目权限相关</a></li><li><a href="/rat-summ/pages/83f9be/" class="sidebar-link">vue项目实践</a></li><li><a href="/rat-summ/pages/22bc61/" class="sidebar-link">vue项目刷新当前页面</a></li><li><a href="/rat-summ/pages/bf319f/" class="sidebar-link">vue中使用jsx</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f75906/" class="sidebar-link">vuex实践使用</a></li><li><a href="/rat-summ/pages/b0eefa/" class="sidebar-link">vuex自定义实现</a></li><li><a href="/rat-summ/pages/f5a30f/" class="sidebar-link">vuex源码分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/213b37/" class="sidebar-link">前端路由的原理及自定义</a></li><li><a href="/rat-summ/pages/1b3a1a/" class="sidebar-link">vue-rouer实践使用</a></li><li><a href="/rat-summ/pages/cf5a75/" class="sidebar-link">vue-router自定义实现</a></li><li><a href="/rat-summ/pages/a2897f/" class="sidebar-link">vue-router源码分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ssr</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ff8fd0/" class="sidebar-link">ssr实践</a></li><li><a href="/rat-summ/pages/b7ed5f/" class="sidebar-link">nuxt实践使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/41364d/" class="sidebar-link">vue-cli实践使用</a></li><li><a href="/rat-summ/pages/313db8/" aria-current="page" class="active sidebar-link">vue-cli自定义实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#第一个版本-v1" class="sidebar-link">第一个版本 v1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#处理用户命令" class="sidebar-link">处理用户命令</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#和用户交互" class="sidebar-link">和用户交互</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#项目模板" class="sidebar-link">项目模板</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#提取-package-json-的部分选项" class="sidebar-link">提取 package.json 的部分选项</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#生成文件" class="sidebar-link">生成文件</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#webpack" class="sidebar-link">webpack</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#添加新功能" class="sidebar-link">添加新功能</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#下载依赖" class="sidebar-link">下载依赖</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#第二个版本-v2" class="sidebar-link">第二个版本 v2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#覆盖和合并" class="sidebar-link">覆盖和合并</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#默认配置和手动模式" class="sidebar-link">默认配置和手动模式</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#包管理器" class="sidebar-link">包管理器</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#切换-npm-源" class="sidebar-link">切换 npm 源</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#将项目功能保存为默认配置" class="sidebar-link">将项目功能保存为默认配置</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#小结" class="sidebar-link">小结</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/313db8/#参考链接" class="sidebar-link">参考链接</a></li></ul></li><li><a href="/rat-summ/pages/71132c/" class="sidebar-link">vue-cli源码分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vue3</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/6c597d/" class="sidebar-link">vue3新特性</a></li><li><a href="/rat-summ/pages/09a8b0/" class="sidebar-link">vue3源码分析</a></li><li><a href="/rat-summ/pages/96b584/" class="sidebar-link">vue3新特性</a></li><li><a href="/rat-summ/pages/d6cc17/" class="sidebar-link">vue3&amp;vite实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Axios</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/e1382d/" class="sidebar-link">Axios分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vuepress</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/388ab8/" class="sidebar-link">vuepress主题模版及实践</a></li><li><a href="/rat-summ/pages/281e9a/" class="sidebar-link">vuepress搭建文档中心</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0413e2/" class="sidebar-link">vue-cli迁移vite2实践小结</a></li><li><a href="/rat-summ/pages/ff4767/" class="sidebar-link">Vite2&amp;React&amp;AntDesign4搭建开发环境</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>组件库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/372ef5/" class="sidebar-link">Vue实现一个Tree组件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>源码分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/125668/" class="sidebar-link">vue源码解密分析开源项目</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpck</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/3793a8/" class="sidebar-link">webpack基础入门</a></li><li><a href="/rat-summ/pages/eb92bd/" class="sidebar-link">webpack中require和import的区别</a></li><li><a href="/rat-summ/pages/d725cb/" class="sidebar-link">webpack中sourcemap详细配置</a></li><li><a href="/rat-summ/pages/1566f7/" class="sidebar-link">webpack的proxy用法</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/1e9637/" class="sidebar-link">webpack的源码分析</a></li><li><a href="/rat-summ/pages/ac0ea5/" class="sidebar-link">webpack路由懒加载的原理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/47b067/" class="sidebar-link">webpack优化总括</a></li><li><a href="/rat-summ/pages/ff5832/" class="sidebar-link">webpack的使用及优化</a></li><li><a href="/rat-summ/pages/540308/" class="sidebar-link">webpack打包构建优化</a></li><li><a href="/rat-summ/pages/e26901/" class="sidebar-link">webpack优化技巧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/000507/" class="sidebar-link">webpack的插件实践</a></li><li><a href="/rat-summ/pages/500de6/" class="sidebar-link">webpack中external实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>react</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f74c57/" class="sidebar-link">react生命周期</a></li><li><a href="/rat-summ/pages/acf75b/" class="sidebar-link">react源码解析</a></li><li><a href="/rat-summ/pages/f7cd7b/" class="sidebar-link">react动态添加样式</a></li><li><a href="/rat-summ/pages/a20232/" class="sidebar-link">componentWillReceiveProps代替方案</a></li><li><a href="/rat-summ/pages/894913/" class="sidebar-link">react的通信方式</a></li><li><a href="/rat-summ/pages/725a47/" class="sidebar-link">react组件通信的方式</a></li><li><a href="/rat-summ/pages/29ef52/" class="sidebar-link">react优化性能技巧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>dva</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d887b1/" class="sidebar-link">dva使用实践</a></li><li><a href="/rat-summ/pages/203fe8/" class="sidebar-link">dva实现原理及自定义实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5c9300/" class="sidebar-link">react-router&amp;dom实践使用</a></li><li><a href="/rat-summ/pages/8a9a13/" class="sidebar-link">react-router&amp;dom自定义实现</a></li><li><a href="/rat-summ/pages/ebc64f/" class="sidebar-link">react-router&amp;dom的源码分析</a></li><li><a href="/rat-summ/pages/ebc3a4/" class="sidebar-link">connected-react-router自定义实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>hooks</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f3a825/" class="sidebar-link">hooks实践</a></li><li><a href="/rat-summ/pages/48c2d2/" class="sidebar-link">hooks自定义实现</a></li><li><a href="/rat-summ/pages/687720/" class="sidebar-link">hooks源码实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>组件库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/400fdf/" class="sidebar-link">通过storybook实现组件库</a></li><li><a href="/rat-summ/pages/f45bc7/" class="sidebar-link">组件发布相关</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f8eee2/" class="sidebar-link">react性能优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>antd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b936a9/" class="sidebar-link">antdv3中使用DatePicker控件</a></li><li><a href="/rat-summ/pages/636811/" class="sidebar-link">antd从v3升级到v4</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>兼容性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>IE</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/9e9433/" class="sidebar-link">解决TextEncoder和TextDecoder在IE下不兼容的问题</a></li><li><a href="/rat-summ/pages/56ba6a/" class="sidebar-link">解决iconfont在IE下不兼容问题</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>常用库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>公共</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5e3047/" class="sidebar-link">常用后台管理模块库</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>jspdf</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/77850d/" class="sidebar-link">pdf生成处理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>dnd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/224401/" class="sidebar-link">react-dnd用法详解</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>protocol</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/23fc68/" class="sidebar-link">常用网络协议关系</a></li><li><a href="/rat-summ/pages/a62613/" class="sidebar-link">http协议相关</a></li><li><a href="/rat-summ/pages/65f844/" class="sidebar-link">websocket的使用</a></li><li><a href="/rat-summ/pages/8231a6/" class="sidebar-link">mqtt的使用</a></li><li><a href="/rat-summ/pages/http-defense/" class="sidebar-link">http防御</a></li><li><a href="/rat-summ/pages/1d91eb/" class="sidebar-link">从url输入到返回请求的过程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>api_权限</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/09a716/" class="sidebar-link">接口请求格式详解</a></li><li><a href="/rat-summ/pages/b2d2c4/" class="sidebar-link">apidoc使用实践</a></li><li><a href="/rat-summ/pages/0de4e4/" class="sidebar-link">前端鉴权知识</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>h5移动</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/560843/" class="sidebar-link">文章推荐</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>性能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ee6f51/" class="sidebar-link">前端性能优化建议</a></li><li><a href="/rat-summ/pages/a79e3a/" class="sidebar-link">前端性能优化2</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>监控</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f0604f/" class="sidebar-link">sentry实践及性能监控</a></li><li><a href="/rat-summ/pages/90f275/" class="sidebar-link">sentry集成钉钉</a></li><li><a href="/rat-summ/pages/72e73a/" class="sidebar-link">常见监控问题汇总</a></li><li><a href="/rat-summ/pages/351a6b/" class="sidebar-link">前端性能监控自己实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>辅助工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a2f35a/" class="sidebar-link">chrome开发者工具的使用</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>组件化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d45aed/" class="sidebar-link">React组件库搭建</a></li><li><a href="/rat-summ/pages/834f6e/" class="sidebar-link">Vue组件库搭建</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>模块化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>模板</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/adm-tpl-sys/" class="sidebar-link">管理端adm-tpl-sys模版</a></li><li><a href="/rat-summ/pages/adm-tpl-sub/" class="sidebar-link">管理端adm-tpl-sub模版</a></li><li><a href="/rat-summ/pages/adm-tpl-portal/" class="sidebar-link">管理端adm-tpl-portal模版</a></li><li><a href="/rat-summ/pages/adm-tpl-port/" class="sidebar-link">管理端adm-tpl-part模版</a></li><li><a href="/rat-summ/pages/adm-tpl-react/" class="sidebar-link">管理端adm-tpl-react模版</a></li><li><a href="/rat-summ/pages/adm-tpl-vue/" class="sidebar-link">管理端adm-tpl-vue模版</a></li><li><a href="/rat-summ/pages/h5-tpl-vue/" class="sidebar-link">移动端h5-tpl-vue模版</a></li><li><a href="/rat-summ/pages/doc-tpl-rat/" class="sidebar-link">管理端doc-tpl-rat模版</a></li><li><a href="/rat-summ/pages/doc-tpl-bdp/" class="sidebar-link">管理端doc-tpl-bdp模版</a></li><li><a href="/rat-summ/pages/adm-tpl-vue-multi/" class="sidebar-link">管理端adm-tpl-vue-multi模版</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>微前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/908314/" class="sidebar-link">微前端概况</a></li><li><a href="/rat-summ/pages/d7e474/" class="sidebar-link">微前端实践使用</a></li><li><a href="/rat-summ/pages/eaf766/" class="sidebar-link">微前端原理实现</a></li><li><a href="/rat-summ/pages/f762ea/" class="sidebar-link">qiankun实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>learn</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/efadb4/" class="sidebar-link">monorepo-lerna-yarn的实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>可视化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>bizchart</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c23b0f/" class="sidebar-link">bizchart基础</a></li><li><a href="/rat-summ/pages/e6701a/" class="sidebar-link">bizchart实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>x6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/bf408c/" class="sidebar-link">x6实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c9a984/" class="sidebar-link">介绍借鉴</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>babel</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/561173/" class="sidebar-link">babel实践及配置</a></li><li><a href="/rat-summ/pages/b5a629/" class="sidebar-link">babel原理及AST</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>gulp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/fb8427/" class="sidebar-link">glup的使用</a></li><li><a href="/rat-summ/pages/013312/" class="sidebar-link">gulp搭建本地服务</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b12f8c/" class="sidebar-link">webpack</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b68d92/" class="sidebar-link">常用的代码规范配置</a></li><li><a href="/rat-summ/pages/e58bf8/" class="sidebar-link">eslint+prettier规范与检测代码</a></li><li><a href="/rat-summ/pages/git-cz-commit/" class="sidebar-link">cz代码提交规范的工作流</a></li><li><a href="/rat-summ/pages/4de8c4/" class="sidebar-link">prettier配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/da383f/" class="sidebar-link">脚手架cli开发</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>构建</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/72751e/" class="sidebar-link">前端构建OOM</a></li><li><a href="/rat-summ/pages/a4bce3/" class="sidebar-link">前端内存分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>uml</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/dfb48b/" class="sidebar-link">UML工具之EA用法</a></li><li><a href="/rat-summ/pages/e3ea8d/" class="sidebar-link">UML基于其的软件设计</a></li><li><a href="/rat-summ/pages/9de482/" class="sidebar-link">UML基于其的需求分析</a></li><li><a href="/rat-summ/pages/49b5ce/" class="sidebar-link">UML基于其的需求分析之案例分析</a></li><li><a href="/rat-summ/pages/456321/" class="sidebar-link">UML用法之基础之基于StarUML</a></li><li><a href="/rat-summ/pages/066f31/" class="sidebar-link">UML用法之进阶之基于EA</a></li><li><a href="/rat-summ/pages/2e78de/" class="sidebar-link">UML之类图分析</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>devops</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>gitd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0e4ee4/" class="sidebar-link">git常用命令及使用</a></li><li><a href="/rat-summ/pages/5f88ca/" class="sidebar-link">git提交规范</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>jenkins</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/cf5bb3/" class="sidebar-link">jenkins配置及使用</a></li><li><a href="/rat-summ/pages/db0083/" class="sidebar-link">jenkins前端构建部署</a></li><li><a href="/rat-summ/pages/e9a204/" class="sidebar-link">Jenkins推送设置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>github</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/github-action/" class="sidebar-link">Github Action自动打包部署</a></li><li><a href="/rat-summ/pages/04ea51/" class="sidebar-link">gitpage设置</a></li><li><a href="/rat-summ/pages/27f7b7/" class="sidebar-link">Github常用自动化及发布设置</a></li><li><a href="/rat-summ/pages/9cd829/" class="sidebar-link">gitlhub&amp;lab几个常用的API</a></li><li><a href="/rat-summ/pages/3a598f/" class="sidebar-link">github墙外</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>bash</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/307097/" class="sidebar-link">前端脚本通过时间生成对应环境</a></li><li><a href="/rat-summ/pages/85b237/" class="sidebar-link">bash判断文件或文件夹是否存在</a></li><li><a href="/rat-summ/pages/39d420/" class="sidebar-link">sed命令替换匹配行</a></li><li><a href="/rat-summ/pages/6b7a10/" class="sidebar-link">shell参数传递与默认值</a></li><li><a href="/rat-summ/pages/6f3fce/" class="sidebar-link">shell交互式传参</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>k8s</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/012f5e/" class="sidebar-link">前端实践k8s</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/857a8b/" class="sidebar-link">docker/compose及swarm的使用</a></li><li><a href="/rat-summ/pages/975a75/" class="sidebar-link">docker常用脚本及工具</a></li><li><a href="/rat-summ/pages/3b2696/" class="sidebar-link">前端常用到的docker容器</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/nginx-base/" class="sidebar-link">nginx环境设置</a></li><li><a href="/rat-summ/pages/nginx-good/" class="sidebar-link">nginx常用设置及实践</a></li><li><a href="/rat-summ/pages/626088/" class="sidebar-link">nginx配置https-http2</a></li><li><a href="/rat-summ/pages/f7b17f/" class="sidebar-link">nginx部署相关</a></li><li><a href="/rat-summ/pages/1fd240/" class="sidebar-link">nginx运维部署相关</a></li><li><a href="/rat-summ/pages/97fccf/" class="sidebar-link">nginx的重定向问题</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ci&amp;cd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/8ceda4/" class="sidebar-link">jenkins构建docker镜像上传至私有镜像库Nexus</a></li><li><a href="/rat-summ/pages/f645ee/" class="sidebar-link">ci&amp;cd通过k8s完整部署</a></li><li><a href="/rat-summ/pages/7860f4/" class="sidebar-link">gitLab搭建cicd</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>deploy</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a991cc/" class="sidebar-link">pm2常用命令及管理</a></li><li><a href="/rat-summ/pages/7e9083/" class="sidebar-link">pm2一键部署</a></li><li><a href="/rat-summ/pages/e5878d/" class="sidebar-link">pm2的实现原理</a></li><li><a href="/rat-summ/pages/2942f3/" class="sidebar-link">ansible部署</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>db</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>nedb</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/275bf3/" class="sidebar-link">nedb的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c3d40c/" class="sidebar-link">mysql类型、储存引擎</a></li><li><a href="/rat-summ/pages/66840d/" class="sidebar-link">mysql事务</a></li><li><a href="/rat-summ/pages/e09335/" class="sidebar-link">mysql优化</a></li><li><a href="/rat-summ/pages/8b0470/" class="sidebar-link">sequelize事务</a></li><li><a href="/rat-summ/pages/408e49/" class="sidebar-link">mysql在win上bat脚本使用</a></li><li><a href="/rat-summ/pages/5ac000/" class="sidebar-link">sqlite的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/098cc4/" class="sidebar-link">redis简介、安装及配置</a></li><li><a href="/rat-summ/pages/7f774f/" class="sidebar-link">redis数据结构、订阅及案例</a></li><li><a href="/rat-summ/pages/7650e0/" class="sidebar-link">redis持久化、缓存及淘汰策略</a></li><li><a href="/rat-summ/pages/b7e7b7/" class="sidebar-link">redis集群、慢查询及内存优化</a></li><li><a href="/rat-summ/pages/0ecb33/" class="sidebar-link">redis事务、锁及分布式</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>业务其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>ambari</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/365af3/" class="sidebar-link">ambari-admin前端二次开发</a></li><li><a href="/rat-summ/pages/365af4/" class="sidebar-link">ambari-web前端二次开发</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>freemarker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/851ff6/" class="sidebar-link">freemarker基本语法</a></li><li><a href="/rat-summ/pages/2a94be/" class="sidebar-link">freemarker与vue实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ember</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0597da/" class="sidebar-link">ember语法</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>go</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/850c2f/" class="sidebar-link">go环境相关配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>mac</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/6a7c2d/" class="sidebar-link">mac中zsh配置</a></li><li><a href="/rat-summ/pages/7c0099/" class="sidebar-link">mac之zip&amp;unzip命令</a></li><li><a href="/rat-summ/pages/00d9cb/" class="sidebar-link">mac常用软件</a></li><li><a href="/rat-summ/pages/f6ec35/" class="sidebar-link">mac上U盘及硬盘数据</a></li><li><a href="/rat-summ/pages/498a75/" class="sidebar-link">homebrew镜像设置</a></li><li><a href="/rat-summ/pages/6d2739/" class="sidebar-link">mac开发环境配置</a></li><li><a href="/rat-summ/pages/fa9bb9/" class="sidebar-link">mac升级固态重装系统</a></li><li><a href="/rat-summ/pages/8ecdf6/" class="sidebar-link">mac打开scp功能</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/037572/" class="sidebar-link">shell脚本实现取当前时间</a></li><li><a href="/rat-summ/pages/6147ef/" class="sidebar-link">linux下通过端口查看进程</a></li><li><a href="/rat-summ/pages/5157d5/" class="sidebar-link">linux权限配置管理</a></li><li><a href="/rat-summ/pages/bc509e/" class="sidebar-link">linux下使用Shell脚本使用ftp</a></li><li><a href="/rat-summ/pages/c74d05/" class="sidebar-link">linux下用户管理</a></li><li><a href="/rat-summ/pages/3654be/" class="sidebar-link">使用samba建立共享文件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>win</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ceea52/" class="sidebar-link">桌面上图标出现x及感叹号处理</a></li><li><a href="/rat-summ/pages/ac4a51/" class="sidebar-link">Chocolatey的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>pi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/8f3e17/" class="sidebar-link">安装MATE及配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>centos</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/52b482/" class="sidebar-link">centos安装配置注意事项</a></li><li><a href="/rat-summ/pages/3a9aef/" class="sidebar-link">centos常用命令</a></li><li><a href="/rat-summ/pages/d8dad9/" class="sidebar-link">centos修改国内yum源</a></li><li><a href="/rat-summ/pages/e672e6/" class="sidebar-link">centos安装vim及配置</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>tool</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>开发工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/fe80ea/" class="sidebar-link">vscode插件开发实践</a></li><li><a href="/rat-summ/pages/42487b/" class="sidebar-link">vscode常用插件及设置</a></li><li><a href="/rat-summ/pages/e7d3cc/" class="sidebar-link">vscode推荐插件分类</a></li><li><a href="/rat-summ/pages/191c13/" class="sidebar-link">谷歌插件推荐</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>命令终端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/13e164/" class="sidebar-link">win终端Cmder配置及美化</a></li><li><a href="/rat-summ/pages/326653/" class="sidebar-link">terminus</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>写作工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f931af/" class="sidebar-link">Markdown For Typora</a></li><li><a href="/rat-summ/pages/e28d3c/" class="sidebar-link">mdeditor完整示例</a></li><li><a href="/rat-summ/pages/8d4c7d/" class="sidebar-link">markdown语法指南</a></li><li><a href="/rat-summ/pages/790131/" class="sidebar-link">typora配合PicGo图床设置</a></li><li><a href="/rat-summ/pages/27f6e7/" class="sidebar-link">使用md语法编写在线文档</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>系统工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ccbd1b/" class="sidebar-link">U盘启动盘制作工具</a></li><li><a href="/rat-summ/pages/ee04b1/" class="sidebar-link">mac上创建可启动USB</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>外部墙</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/10414e/" class="sidebar-link">内网穿透</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>design_pattern</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5a8250/" class="sidebar-link">设计模式js版</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>algorithm</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/bd8a49/" class="sidebar-link">十大经典排序算法js版</a></li><li><a href="/rat-summ/pages/9456b9/" class="sidebar-link">数据结构及常用算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>android</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>junior</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/1a7f5c/" class="sidebar-link">Android开发环境搭建和其相关配置</a></li><li><a href="/rat-summ/pages/81c564/" class="sidebar-link">Android开发环境搭建和其相关配之Linux</a></li><li><a href="/rat-summ/pages/ffd4b8/" class="sidebar-link">Android代码编程规范</a></li><li><a href="/rat-summ/pages/dfe80b/" class="sidebar-link">Android网络基础</a></li><li><a href="/rat-summ/pages/8633a7/" class="sidebar-link">Android应用部署与发布</a></li><li><a href="/rat-summ/pages/7cdbb0/" class="sidebar-link">Android动画框架概括</a></li><li><a href="/rat-summ/pages/5a0b8f/" class="sidebar-link">Android动画框架基础</a></li><li><a href="/rat-summ/pages/1400a2/" class="sidebar-link">Android动画框架进阶</a></li><li><a href="/rat-summ/pages/b454ea/" class="sidebar-link">Android应用学习进阶步骤之面试参照</a></li><li><a href="/rat-summ/pages/d2f94b/" class="sidebar-link">Android应用学习进阶之初级</a></li><li><a href="/rat-summ/pages/915eb9/" class="sidebar-link">Android应用市场发布流程之运营&amp;推广</a></li><li><a href="/rat-summ/pages/08917a/" class="sidebar-link">Android开发新规范整理</a></li><li><a href="/rat-summ/pages/d0f4bc/" class="sidebar-link">gradle构建脚本优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>intermediate</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ccb0c1/" class="sidebar-link">Android应用学习进阶之中级</a></li><li><a href="/rat-summ/pages/9142c5/" class="sidebar-link">Android通信协议简述</a></li><li><a href="/rat-summ/pages/194d22/" class="sidebar-link">Android通讯协议之蓝牙基础</a></li><li><a href="/rat-summ/pages/867adf/" class="sidebar-link">Android自定义控件基础之事件分发和绘制</a></li><li><a href="/rat-summ/pages/c71d42/" class="sidebar-link">Android自定义控件基础分类及示例</a></li><li><a href="/rat-summ/pages/da843a/" class="sidebar-link">Android编译脚本比较</a></li><li><a href="/rat-summ/pages/d560aa/" class="sidebar-link">NDK开发实践之基础</a></li><li><a href="/rat-summ/pages/4c7165/" class="sidebar-link">NDK开发实践之基础之C语言</a></li><li><a href="/rat-summ/pages/e49fbf/" class="sidebar-link">NDK开发实践之案例</a></li><li><a href="/rat-summ/pages/d496f9/" class="sidebar-link">NDK开发实践之进阶</a></li><li><a href="/rat-summ/pages/021c3f/" class="sidebar-link">NDK开发环境搭建及初探</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>senior</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/e671f8/" class="sidebar-link">Andriod框架分析</a></li><li><a href="/rat-summ/pages/b0596b/" class="sidebar-link">Andriod性能分析之概括</a></li><li><a href="/rat-summ/pages/2e3a59/" class="sidebar-link">Andoid内存泄露案例分析</a></li><li><a href="/rat-summ/pages/1b95c7/" class="sidebar-link">Andriod性能分析之布局优化</a></li><li><a href="/rat-summ/pages/2aaf64/" class="sidebar-link">Andriod性能分析之代码优化</a></li><li><a href="/rat-summ/pages/2cbead/" class="sidebar-link">Android插件化开发</a></li><li><a href="/rat-summ/pages/fed762/" class="sidebar-link">Android内存分析及工具</a></li><li><a href="/rat-summ/pages/4b05ec/" class="sidebar-link">Android热插拔式开发</a></li><li><a href="/rat-summ/pages/02abfa/" class="sidebar-link">Dagger2&amp;Retrofit&amp;Mvp&amp;Rxjava使用</a></li><li><a href="/rat-summ/pages/60efda/" class="sidebar-link">设计模式designpattern之Android</a></li><li><a href="/rat-summ/pages/bada8a/" class="sidebar-link">Android应用学习进阶之高级</a></li><li><a href="/rat-summ/pages/0a09ed/" class="sidebar-link">Android代码重构杂谈</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>frame_analysis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7181c5/" class="sidebar-link">photoview框架总体类关系类图</a></li><li><a href="/rat-summ/pages/f07699/" class="sidebar-link">photoview_gestures类图</a></li><li><a href="/rat-summ/pages/0566ed/" class="sidebar-link">photoview_scrollerproxy类图</a></li><li><a href="/rat-summ/pages/28ea8c/" class="sidebar-link">photoview时序图</a></li><li><a href="/rat-summ/pages/af1b33/" class="sidebar-link">universalimageloader总体分析类图</a></li><li><a href="/rat-summ/pages/8dd63e/" class="sidebar-link">universalimageloader图片显示时序图</a></li><li><a href="/rat-summ/pages/7d2b7c/" class="sidebar-link">volley总体分析类图</a></li><li><a href="/rat-summ/pages/a4c1ca/" class="sidebar-link">volley网络调用时序图</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>source_analysis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/2ecf5f/" class="sidebar-link">Activity的Window创建的过程</a></li><li><a href="/rat-summ/pages/6d05ab/" class="sidebar-link">Android事件分发活动图</a></li><li><a href="/rat-summ/pages/05ad73/" class="sidebar-link">AppWidget相关类关系类图</a></li><li><a href="/rat-summ/pages/864ebd/" class="sidebar-link">AppWidget桌面小部件时序图</a></li><li><a href="/rat-summ/pages/b14b32/" class="sidebar-link">drawable的层次关系类图</a></li><li><a href="/rat-summ/pages/2381fb/" class="sidebar-link">Toast的Window创建过程</a></li><li><a href="/rat-summ/pages/d745fa/" class="sidebar-link">Window的操作过程时序图</a></li><li><a href="/rat-summ/pages/9d06cb/" class="sidebar-link">窗口视图相关类图</a></li><li><a href="/rat-summ/pages/6e02c2/" class="sidebar-link">视图相关类图</a></li><li><a href="/rat-summ/pages/f629a5/" class="sidebar-link">总体视图组的继承结构类图</a></li><li><a href="/rat-summ/pages/41aaa3/" class="sidebar-link">Notification通知栏时序图</a></li><li><a href="/rat-summ/pages/724c2f/" class="sidebar-link">Notification相关类关系类图</a></li><li><a href="/rat-summ/pages/253188/" class="sidebar-link">ViewGroup的绘制活动图</a></li><li><a href="/rat-summ/pages/8b3d65/" class="sidebar-link">ViewGroup和View总体案例分析活动图</a></li><li><a href="/rat-summ/pages/1bd9c4/" class="sidebar-link">ViewGroup事件分发活动图</a></li><li><a href="/rat-summ/pages/1cbc66/" class="sidebar-link">View的绘制活动图</a></li><li><a href="/rat-summ/pages/bb8651/" class="sidebar-link">View事件分发活动图</a></li><li><a href="/rat-summ/pages/42270e/" class="sidebar-link">View中draw子流程活动图</a></li><li><a href="/rat-summ/pages/8f70a5/" class="sidebar-link">消息处理机制时序图</a></li><li><a href="/rat-summ/pages/9787fb/" class="sidebar-link">消息处理机制相关类关系类图</a></li></ul></section></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/rat-summ/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><span data-v-1cd794fe>《技能记录》</span></li> <li data-v-1cd794fe><span data-v-1cd794fe>vue</span></li> <li data-v-1cd794fe><span data-v-1cd794fe>cli</span></li></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/samyzh" target="_blank" title="作者" class="beLink" data-v-1cd794fe>samy</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-02-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          vue-cli自定义实现
        </h1>  <div class="theme-vdoing-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>最近在学习 <a href="https://github.com/vuejs/vue-cli" target="_blank" rel="noopener noreferrer">vue-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的源码，获益良多。为了让自己理解得更加深刻，我决定模仿它造一个轮子，争取尽可能多的实现原有的功能。</p> <p>我将这个轮子分成三个版本：</p> <ol><li>尽可能用最少的代码实现一个最简版本的脚手架。</li> <li>在 1 的基础上添加一些辅助功能，例如选择包管理器、npm 源等等。</li> <li>实现插件化，可以自由的进行扩展。在不影响内部源码的情况下，添加功能。</li></ol> <p>有人可能不懂脚手架是什么。按我的理解，脚手架就是帮助你把项目的基础架子搭好。例如项目依赖、模板、构建工具等等。让你不用从零开始配置一个项目，尽可能快的进行业务开发。</p> <p>建议在阅读本文时，能够结合项目源码一起配合使用，效果更好。这是项目地址 <a href="https://github.com/woai3c/mini-cli" target="_blank" rel="noopener noreferrer">mini-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。项目中的每一个分支都对应一个版本，例如第一个版本对应的 git 分支为 v1。所以在阅读源码时，记得要切换到对应的分支。</p> <p><img src="/rat-summ/assets/img/21528a60b4b9470a9cf583bcc9edcbd2~tplv-k3u1fbpfcp-watermark.120772f5.png" alt="img"></p> <h2 id="第一个版本-v1"><a href="#第一个版本-v1" class="header-anchor">#</a> 第一个版本 v1</h2> <p>第一个版本的功能比较简单，大致为：</p> <ol><li>用户输入命令，准备创建项目。</li> <li>脚手架解析用户命令，并弹出交互语句，询问用户创建项目需要哪些功能。</li> <li>用户选择自己需要的功能。</li> <li>脚手架根据用户的选择创建 <code>package.json</code> 文件，并添加对应的依赖项。</li> <li>脚手架根据用户的选择渲染项目模板，生成文件（例如 <code>index.html</code>、<code>main.js</code>、<code>App.vue</code> 等文件）。</li> <li>执行 <code>npm install</code> 命令安装依赖。</li></ol> <p>项目目录树：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>├─.vscode
├─bin 
│  ├─mvc.js <span class="token comment"># mvc 全局命令</span>
├─lib
│  ├─generator <span class="token comment"># 各个功能的模板</span>
│  │  ├─babel <span class="token comment"># babel 模板</span>
│  │  ├─linter <span class="token comment"># eslint 模板</span>
│  │  ├─router <span class="token comment"># vue-router 模板</span>
│  │  ├─vue <span class="token comment"># vue 模板</span>
│  │  ├─vuex <span class="token comment"># vuex 模板</span>
│  │  └─webpack <span class="token comment"># webpack 模板</span>
│  ├─promptModules <span class="token comment"># 各个模块的交互提示语</span>
│  └─utils <span class="token comment"># 一系列工具函数</span>
│  ├─create.js <span class="token comment"># create 命令处理函数</span>
│  ├─Creator.js <span class="token comment"># 处理交互提示</span>
│  ├─Generator.js <span class="token comment"># 渲染模板</span>
│  ├─PromptModuleAPI.js <span class="token comment"># 将各个功能的提示语注入 Creator</span>
└─scripts <span class="token comment"># commit message 验证脚本 和项目无关 不需关注</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="处理用户命令"><a href="#处理用户命令" class="header-anchor">#</a> 处理用户命令</h3> <p>脚手架第一个功能就是处理用户的命令，这需要使用 <a href="https://github.com/tj/commander.js/blob/master/Readme_zh-CN.md" target="_blank" rel="noopener noreferrer">commander.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。这个库的功能就是解析用户的命令，提取出用户的输入交给脚手架。例如这段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'commander'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> create <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../lib/create'</span><span class="token punctuation">)</span>

program
<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">'0.1.0'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'create &lt;name&gt;'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'create a new project'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    <span class="token function">create</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

program<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>它使用 commander 注册了一个 <code>create</code> 命令，并设置了脚手架的版本和描述。我将这段代码保存在项目下的 <code>bin</code> 目录，并命名为 <code>mvc.js</code>。然后在 <code>package.json</code> 文件添加这段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;mvc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/mvc.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>再执行 <a href="https://docs.npmjs.com/cli/v7/commands/npm-link" target="_blank" rel="noopener noreferrer">npm link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，就可以将 <code>mvc</code> 注册成全局命令。这样在电脑上的任何地方都能使用 <code>mvc</code> 命令了。实际上，就是用 <code>mvc</code> 命令来代替执行 <code>node ./bin/mvc.js</code>。</p> <p>假设用户在命令行上输入 <code>mvc create demo</code>（实际上执行的是 <code>node ./bin/mvc.js create demo</code>），<code>commander</code> 解析到命令 <code>create</code> 和参数 <code>demo</code>。然后脚手架可以在 <code>action</code> 回调里取到参数 <code>name</code>（值为 demo）。</p> <h3 id="和用户交互"><a href="#和用户交互" class="header-anchor">#</a> 和用户交互</h3> <p>取到用户要创建的项目名称 <code>demo</code> 之后，就可以弹出交互选项，询问用户要创建的项目需要哪些功能。这需要用到 <a href="https://github.com/SBoudrias/Inquirer.js/" target="_blank" rel="noopener noreferrer">Inquirer.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。<code>Inquirer.js</code> 的功能就是弹出一个问题和一些选项，让用户选择。并且选项可以指定是多选、单选等等。</p> <p>例如下面的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;features&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项名称</span>
        <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Check the features needed for your project:&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项提示语</span>
        <span class="token string">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;checkbox&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项类型 另外还有 confirm list 等</span>
        <span class="token string">&quot;choices&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 具体的选项</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;short&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Transpile modern JavaScript to older versions (for compatibility)&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://babeljs.io/&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;checked&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Router&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;router&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Structure the app with dynamic pages&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://router.vuejs.org/&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>prompts<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>弹出的问题和选项如下：</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>问题的类型 <code>&quot;type&quot;: &quot;checkbox&quot;</code> 是 <code>checkbox</code> 说明是多选。如果两个选项都进行选中的话，返回来的值为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span> features<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中 <code>features</code> 是上面问题中的 <code>name</code> 属性。<code>features</code> 数组中的值则是每个选项中的 <code>value</code>。</p> <p><code>Inquirer.js</code> 还可以提供具有相关性的问题，也就是上一个问题选择了指定的选项，下一个问题才会显示出来。例如下面的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Router'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'router'</span><span class="token punctuation">,</span>
    description<span class="token operator">:</span> <span class="token string">'Structure the app with dynamic pages'</span><span class="token punctuation">,</span>
    link<span class="token operator">:</span> <span class="token string">'https://router.vuejs.org/'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'historyMode'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">when</span><span class="token operator">:</span> <span class="token parameter">answers</span> <span class="token operator">=&gt;</span> answers<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'router'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
    message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Use history mode for router? </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">yellow</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(Requires proper server setup for index fallback in production)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    description<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">By using the HTML5 History API, the URLs don't need the '#' character anymore.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    link<span class="token operator">:</span> <span class="token string">'https://router.vuejs.org/guide/essentials/history-mode.html'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>第二个问题中有一个属性 <code>when</code>，它的值是一个函数 <code>answers =&gt; answers.features.includes('router')</code>。当函数的执行结果为 <code>true</code>，第二个问题才会显示出来。如果你在上一个问题中选择了 <code>router</code>，它的结果就会变为 <code>true</code>。弹出第二个问题：问你路由模式是否选择 <code>history</code> 模式。</p> <p>大致了解 <code>Inquirer.js</code> 后，就可以明白这一步我们要做什么了。主要就是将脚手架支持的功能配合对应的问题、可选值在控制台上展示出来，供用户选择。获取到用户具体的选项值后，再渲染模板和依赖。</p> <h4 id="有哪些功能"><a href="#有哪些功能" class="header-anchor">#</a> 有哪些功能</h4> <p>先来看一下第一个版本支持哪些功能：</p> <ul><li>vue</li> <li>vue-router</li> <li>vuex</li> <li>babel</li> <li>webpack</li> <li>linter(eslint)</li></ul> <p>由于这是一个 vue 相关的脚手架，所以 vue 是默认提供的，不需要用户选择。另外构建工具 webpack 提供了开发环境和打包的功能，也是必需的，不用用户进行选择。所以可供用户选择的功能只有 4 个：</p> <ul><li>vue-router</li> <li>vuex</li> <li>babel</li> <li>linter</li></ul> <p>现在我们先来看一下这 4 个功能对应的交互提示语相关的文件。它们全部放在 <code>lib/promptModules</code> 目录下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">-</span>babel<span class="token punctuation">.</span>js
<span class="token operator">-</span>linter<span class="token punctuation">.</span>js
<span class="token operator">-</span>router<span class="token punctuation">.</span>js
<span class="token operator">-</span>vuex<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>每个文件包含了和它相关的所有交互式问题。例如刚才的示例，说明 <code>router</code> 相关的问题有两个。下面再看一下 <code>babel.js</code> 的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">api</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    api<span class="token punctuation">.</span><span class="token function">injectFeature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'Babel'</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span> <span class="token string">'babel'</span><span class="token punctuation">,</span>
        short<span class="token operator">:</span> <span class="token string">'Babel'</span><span class="token punctuation">,</span>
        description<span class="token operator">:</span> <span class="token string">'Transpile modern JavaScript to older versions (for compatibility)'</span><span class="token punctuation">,</span>
        link<span class="token operator">:</span> <span class="token string">'https://babeljs.io/'</span><span class="token punctuation">,</span>
        checked<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>只有一个问题，就是问下用户需不需要 <code>babel</code> 功能，默认为 <code>checked: true</code>，也就是需要。</p> <h4 id="注入问题"><a href="#注入问题" class="header-anchor">#</a> 注入问题</h4> <p>用户使用 <code>create</code> 命令后，脚手架需要将所有功能的交互提示语句聚合在一起：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// craete.js</span>
<span class="token keyword">const</span> creator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Creator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获取各个模块的交互提示语</span>
<span class="token keyword">const</span> promptModules <span class="token operator">=</span> <span class="token function">getPromptModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> promptAPI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PromptModuleAPI</span><span class="token punctuation">(</span>creator<span class="token punctuation">)</span>
promptModules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=&gt;</span> <span class="token function">m</span><span class="token punctuation">(</span>promptAPI<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 清空控制台</span>
<span class="token function">clearConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 弹出交互提示语并获取用户的选择</span>
<span class="token keyword">const</span> answers <span class="token operator">=</span> <span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>creator<span class="token punctuation">.</span><span class="token function">getFinalPrompts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token keyword">function</span> <span class="token function">getPromptModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token string">'babel'</span><span class="token punctuation">,</span>
        <span class="token string">'router'</span><span class="token punctuation">,</span>
        <span class="token string">'vuex'</span><span class="token punctuation">,</span>
        <span class="token string">'linter'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./promptModules/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Creator.js</span>
<span class="token keyword">class</span> <span class="token class-name">Creator</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>featurePrompt <span class="token operator">=</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'features'</span><span class="token punctuation">,</span>
            message<span class="token operator">:</span> <span class="token string">'Check the features needed for your project:'</span><span class="token punctuation">,</span>
            pageSize<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'checkbox'</span><span class="token punctuation">,</span>
            choices<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>injectedPrompts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token function">getFinalPrompts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>injectedPrompts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">prompt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> originalWhen <span class="token operator">=</span> prompt<span class="token punctuation">.</span>when <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
            prompt<span class="token punctuation">.</span><span class="token function-variable function">when</span> <span class="token operator">=</span> <span class="token parameter">answers</span> <span class="token operator">=&gt;</span> <span class="token function">originalWhen</span><span class="token punctuation">(</span>answers<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
        <span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>featurePrompt<span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>injectedPrompts<span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    
        <span class="token keyword">return</span> prompts
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Creator


<span class="token comment">// PromptModuleAPI.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">PromptModuleAPI</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">creator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>creator <span class="token operator">=</span> creator
    <span class="token punctuation">}</span>

    <span class="token function">injectFeature</span><span class="token punctuation">(</span><span class="token parameter">feature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>creator<span class="token punctuation">.</span>featurePrompt<span class="token punctuation">.</span>choices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">injectPrompt</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>creator<span class="token punctuation">.</span>injectedPrompts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p>以上代码的逻辑如下：</p> <ol><li>创建 <code>creator</code> 对象</li> <li>调用 <code>getPromptModules()</code> 获取所有功能的交互提示语</li> <li>再调用 <code>PromptModuleAPI</code> 将所有交互提示语注入到 <code>creator</code> 对象</li> <li>通过 <code>const answers = await inquirer.prompt(creator.getFinalPrompts())</code> 在控制台弹出交互语句，并将用户选择结果赋值给 <code>answers</code> 变量。</li></ol> <p>如果所有功能都选上，<code>answers</code> 的值为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  features<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">,</span> <span class="token string">'vuex'</span><span class="token punctuation">,</span> <span class="token string">'linter'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 项目具有的功能</span>
  historyMode<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 路由是否使用 history 模式</span>
  eslintConfig<span class="token operator">:</span> <span class="token string">'airbnb'</span><span class="token punctuation">,</span> <span class="token comment">// esilnt 校验代码的默认规则，可被覆盖</span>
  lintOn<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'save'</span> <span class="token punctuation">]</span> <span class="token comment">// 保存代码时进行校验</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="项目模板"><a href="#项目模板" class="header-anchor">#</a> 项目模板</h3> <p>获取用户的选项后就该开始渲染模板和生成 <code>package.json</code> 文件了。先来看一下如何生成 <code>package.json</code> 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// package.json 文件内容</span>
<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">,</span>
    version<span class="token operator">:</span> <span class="token string">'0.1.0'</span><span class="token punctuation">,</span>
    dependencies<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    devDependencies<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>先定义一个 <code>pkg</code> 变量来表示 <code>package.json</code> 文件，并设定一些默认值。</p> <p>所有的项目模板都放在 <code>lib/generator</code> 目录下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>├─lib
│  ├─generator <span class="token comment"># 各个功能的模板</span>
│  │  ├─babel <span class="token comment"># babel 模板</span>
│  │  ├─linter <span class="token comment"># eslint 模板</span>
│  │  ├─router <span class="token comment"># vue-router 模板</span>
│  │  ├─vue <span class="token comment"># vue 模板</span>
│  │  ├─vuex <span class="token comment"># vuex 模板</span>
│  │  └─webpack <span class="token comment"># webpack 模板</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>每个模板的功能都差不多：</p> <ol><li>向 <code>pkg</code> 变量注入依赖项</li> <li>提供模板文件</li></ol> <h4 id="注入依赖"><a href="#注入依赖" class="header-anchor">#</a> 注入依赖</h4> <p>下面是 <code>babel</code> 相关的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    generator<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        babel<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        dependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'core-js'</span><span class="token operator">:</span> <span class="token string">'^3.8.3'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        devDependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'@babel/core'</span><span class="token operator">:</span> <span class="token string">'^7.12.13'</span><span class="token punctuation">,</span>
            <span class="token string">'@babel/preset-env'</span><span class="token operator">:</span> <span class="token string">'^7.12.13'</span><span class="token punctuation">,</span>
            <span class="token string">'babel-loader'</span><span class="token operator">:</span> <span class="token string">'^8.2.2'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>可以看到，模板调用 <code>generator</code> 对象的 <code>extendPackage()</code> 方法向 <code>pkg</code> 变量注入了 <code>babel</code> 相关的所有依赖。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token parameter">fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pkg
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> fields<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token keyword">const</span> existing <span class="token operator">=</span> pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'dependencies'</span> <span class="token operator">||</span> key <span class="token operator">===</span> <span class="token string">'devDependencies'</span> <span class="token operator">||</span> key <span class="token operator">===</span> <span class="token string">'scripts'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>existing <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>注入依赖的过程就是遍历所有用户已选择的模板，并调用 <code>extendPackage()</code> 注入依赖。</p> <h4 id="渲染模板"><a href="#渲染模板" class="header-anchor">#</a> 渲染模板</h4> <p>脚手架是怎么渲染模板的呢？用 <code>vuex</code> 举例，先看一下它的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// 向入口文件 `src/main.js` 注入代码 import store from './store'</span>
    generator<span class="token punctuation">.</span><span class="token function">injectImports</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import store from './store'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	
    <span class="token comment">// 向入口文件 `src/main.js` 的 new Vue() 注入选项 store</span>
    generator<span class="token punctuation">.</span><span class="token function">injectRootOptions</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	
    <span class="token comment">// 注入依赖</span>
    generator<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        dependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
            vuex<span class="token operator">:</span> <span class="token string">'^3.6.2'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	
    <span class="token comment">// 渲染模板</span>
    generator<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>可以看到渲染的代码为 <code>generator.render('./template', {})</code>。<code>./template</code> 是模板目录的路径：</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>所有的模板代码都放在 <code>template</code> 目录下，<code>vuex</code> 将会在用户创建的目录下的 <code>src</code> 目录生成 <code>store</code> 文件夹，里面有一个 <code>index.js</code> 文件。它的内容为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>这里简单描述一下 <code>generator.render()</code> 的渲染过程。</p> <p><strong>第一步</strong>， 使用 <a href="https://github.com/sindresorhus/globby" target="_blank" rel="noopener noreferrer">globby<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 读取模板目录下的所有文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> _files <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">globby</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'**/*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cwd<span class="token operator">:</span> source<span class="token punctuation">,</span> dot<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>第二步</strong>，遍历所有读取的文件。如果文件是二进制文件，则不作处理，渲染时直接生成文件。否则读取文件内容，再调用 <a href="https://github.com/mde/ejs" target="_blank" rel="noopener noreferrer">ejs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行渲染：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 返回文件内容</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> data<span class="token punctuation">,</span> ejsOptions<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>使用 <code>ejs</code> 的好处，就是可以结合变量来决定是否渲染某些代码。例如 <code>webpack</code> 的模板中有这样一段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
      rules<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token operator">&lt;</span><span class="token operator">%</span>_ <span class="token keyword">if</span> <span class="token punctuation">(</span>hasBabel<span class="token punctuation">)</span> <span class="token punctuation">{</span> _<span class="token operator">%</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span>
              test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
              loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
              exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token operator">&lt;</span><span class="token operator">%</span>_ <span class="token punctuation">}</span> _<span class="token operator">%</span><span class="token operator">&gt;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>ejs</code> 可以根据用户是否选择了 <code>babel</code> 来决定是否渲染这段代码。如果 <code>hasBabel</code> 为 <code>false</code>，则这段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
    exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>将不会被渲染出来。<code>hasBabel</code> 的值是调用 <code>render()</code> 时用参数传过去的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>generator<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    hasBabel<span class="token operator">:</span> options<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'babel'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    lintOnSave<span class="token operator">:</span> options<span class="token punctuation">.</span>lintOn<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'save'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>第三步</strong>，注入特定代码。回想一下刚才 <code>vuex</code> 中的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 向入口文件 `src/main.js` 注入代码 import store from './store'</span>
generator<span class="token punctuation">.</span><span class="token function">injectImports</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import store from './store'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

<span class="token comment">// 向入口文件 `src/main.js` 的 new Vue() 注入选项 store</span>
generator<span class="token punctuation">.</span><span class="token function">injectRootOptions</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这两行代码的作用是：在项目入口文件 <code>src/main.js</code> 中注入特定的代码。</p> <p><code>vuex</code> 是 <code>vue</code> 的一个状态管理库，属于 <code>vue</code> 全家桶中的一员。如果创建的项目没有选择 <code>vuex</code> 和 <code>vue-router</code>。则 <code>src/main.js</code> 的代码为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果选择了 <code>vuex</code>，它会注入上面所说的两行代码，现在 <code>src/main.js</code> 代码变为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span> <span class="token comment">// 注入的代码</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  store<span class="token punctuation">,</span> <span class="token comment">// 注入的代码</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这里简单描述一下代码的注入过程：</p> <ol><li>使用 <a href="https://github.com/vuejs/vue-codemod" target="_blank" rel="noopener noreferrer">vue-codemod<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 将代码解析成语法抽象树 AST。</li> <li>然后将要插入的代码变成 AST 节点插入到上面所说的 AST 中。</li> <li>最后将新的 AST 重新渲染成代码。</li></ol> <h3 id="提取-package-json-的部分选项"><a href="#提取-package-json-的部分选项" class="header-anchor">#</a> 提取 <code>package.json</code> 的部分选项</h3> <p>一些第三方库的配置项可以放在 <code>package.json</code> 文件，也可以自己独立生成一份文件。例如 <code>babel</code> 在 <code>package.json</code> 中注入的配置为：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>babel<span class="token operator">:</span> <span class="token punctuation">{</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span>'@babel/preset-env'<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>我们可以调用 <code>generator.extractConfigFiles()</code> 将内容提取出来并生成 <code>babel.config.js</code> 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="生成文件"><a href="#生成文件" class="header-anchor">#</a> 生成文件</h3> <p>渲染好的模板文件和 <code>package.json</code> 文件目前还是在内存中，并没有真正的在硬盘上创建。这时可以调用 <code>writeFileTree()</code> 将文件生成：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs-extra'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">writeFileTree</span><span class="token punctuation">(</span><span class="token parameter">dir<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
        fs<span class="token punctuation">.</span><span class="token function">ensureDirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> files<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这段代码的逻辑如下：</p> <ol><li>遍历所有渲染好的文件，逐一生成。</li> <li>在生成一个文件时，确认它的父目录在不在，如果不在，就先生成父目录。</li> <li>写入文件。</li></ol> <p>例如现在一个文件路径为 <code>src/test.js</code>，第一次写入时，由于还没有 <code>src</code> 目录。所以会先生成 <code>src</code> 目录，再生成 <code>test.js</code> 文件。</p> <h3 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h3> <p>webpack 需要提供开发环境下的热加载、编译等服务，还需要提供打包服务。目前 webpack 的代码比较少，功能比较简单。而且生成的项目中，webpack 配置代码是暴露出来的。这留待 v3 版本再改进。</p> <h3 id="添加新功能"><a href="#添加新功能" class="header-anchor">#</a> 添加新功能</h3> <p>添加一个新功能，需要在两个地方添加代码：分别是 <code>lib/promptModules</code> 和 <code>lib/generator</code>。在 <code>lib/promptModules</code> 中添加的是这个功能相关的交互提示语。在 <code>lib/generator</code> 中添加的是这个功能相关的依赖和模板代码。</p> <p>不过不是所有的功能都需要添加模板代码的，例如 <code>babel</code> 就不需要。在添加新功能时，有可能会对已有的模板代码造成影响。例如我现在需要项目支持 <code>ts</code>。除了添加 <code>ts</code> 相关的依赖，还得在 <code>webpack</code> <code>vue</code> <code>vue-router</code> <code>vuex</code> <code>linter</code> 等功能中修改原有的模板代码。</p> <p>举个例子，在 <code>vue-router</code> 中，如果支持 <code>ts</code>，则这段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">// ... ]</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>需要修改为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">%</span>_ <span class="token keyword">if</span> <span class="token punctuation">(</span>hasTypeScript<span class="token punctuation">)</span> <span class="token punctuation">{</span> _<span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token keyword">const</span> routes<span class="token operator">:</span> Array<span class="token operator">&lt;</span>RouteConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">// ... ]</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>_ <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> _<span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">// ... ]</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>_ <span class="token punctuation">}</span> _<span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>因为 <code>ts</code> 的值有类型。</p> <p>总之，添加的新功能越多，各个功能的模板代码也会越来越多。并且还需要考虑到各个功能之间的影响。</p> <h3 id="下载依赖"><a href="#下载依赖" class="header-anchor">#</a> 下载依赖</h3> <p>下载依赖需要使用 <a href="https://github.com/sindresorhus/execa" target="_blank" rel="noopener noreferrer">execa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，它可以调用子进程执行命令。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> execa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'execa'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">executeCommand</span><span class="token punctuation">(</span><span class="token parameter">command<span class="token punctuation">,</span> cwd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            cwd<span class="token punctuation">,</span>
            stdio<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'inherit'</span><span class="token punctuation">,</span> <span class="token string">'pipe'</span><span class="token punctuation">,</span> <span class="token string">'inherit'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">buffer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        child<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token parameter">code</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">command failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>command<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>

            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// create.js 文件</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\n正在下载依赖...\n'</span><span class="token punctuation">)</span>
<span class="token comment">// 下载依赖</span>
<span class="token keyword">await</span> <span class="token function">executeCommand</span><span class="token punctuation">(</span><span class="token string">'npm install'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\n依赖下载完成! 执行下列命令开始开发：\n'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">npm run dev</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>调用 <code>executeCommand()</code> 开始下载依赖，参数为 <code>npm install</code> 和用户创建的项目路径。为了能让用户看到下载依赖的过程，我们需要使用下面的代码将子进程的输出传给主进程，也就是输出到控制台：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">buffer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>下面我用动图演示一下 v1 版本的创建过程：</p> <p><img src="/rat-summ/assets/img/65b515014470417084aaf7bbd2f1c695~tplv-k3u1fbpfcp-watermark.e1b7a36f.png" alt="img"></p> <p>创建成功的项目截图：</p> <p><img src="/rat-summ/assets/img/9059e85152b343b0b6430a760df3bd14~tplv-k3u1fbpfcp-watermark.5b8498e0.png" alt="img"></p> <p><img src="data:image/png;base64,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" alt="img"></p> <h2 id="第二个版本-v2"><a href="#第二个版本-v2" class="header-anchor">#</a> 第二个版本 v2</h2> <p>第二个版本在 v1 的基础上添加了一些辅助功能：</p> <ol><li>创建项目时判断该项目是否已存在，支持覆盖和合并创建。</li> <li>选择功能时提供默认配置和手动选择两种模式。</li> <li>如果用户的环境同时存在 yarn 和 npm，则会提示用户要使用哪个包管理器。</li> <li>如果 npm 的默认源速度比较慢，则提示用户是否要切换到淘宝源。</li> <li>如果用户是手动选择功能，在结束后会询问用户是否要将这次的选择保存为默认配置。</li></ol> <h3 id="覆盖和合并"><a href="#覆盖和合并" class="header-anchor">#</a> 覆盖和合并</h3> <p>创建项目时，先提前判断一下该项目是否存在：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> targetDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token comment">// 如果目标目录已存在，询问是覆盖还是合并</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 清空控制台</span>
    <span class="token function">clearConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> action <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'action'</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
            message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Target directory </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">cyan</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> already exists. Pick an action:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            choices<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Overwrite'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'overwrite'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Merge'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'merge'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">===</span> <span class="token string">'overwrite'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\nRemoving </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">cyan</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><img src="data:image/png;base64,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" alt="img"></p> <p>如果选择 <code>overwrite</code>，则进行移除 <code>fs.remove(targetDir)</code>。</p> <h3 id="默认配置和手动模式"><a href="#默认配置和手动模式" class="header-anchor">#</a> 默认配置和手动模式</h3> <p>先在代码中提前把默认配置的代码写好：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>exports<span class="token punctuation">.</span>defaultPreset <span class="token operator">=</span> <span class="token punctuation">{</span>
    features<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'linter'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    historyMode<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    eslintConfig<span class="token operator">:</span> <span class="token string">'airbnb'</span><span class="token punctuation">,</span>
    lintOn<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'save'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这个配置默认使用 <code>babel</code> 和 <code>eslint</code>。</p> <p>然后生成交互提示语时，先调用 <code>getDefaultPrompts()</code> 方法获取默认配置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">getDefaultPrompts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> presets <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPresets</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> presetChoices <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>presets<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>name<span class="token punctuation">,</span> preset<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> displayName <span class="token operator">=</span> name

        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>displayName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>preset<span class="token punctuation">.</span>features<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            value<span class="token operator">:</span> name<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> presetPrompt <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'preset'</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Please pick a preset:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        choices<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">// 默认配置</span>
            <span class="token operator">...</span>presetChoices<span class="token punctuation">,</span>
            <span class="token comment">// 这是手动模式提示语</span>
            <span class="token punctuation">{</span>
                name<span class="token operator">:</span> <span class="token string">'Manually select features'</span><span class="token punctuation">,</span>
                value<span class="token operator">:</span> <span class="token string">'__manual__'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> featurePrompt <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'features'</span><span class="token punctuation">,</span>
        when<span class="token operator">:</span> isManualMode<span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'checkbox'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'Check the features needed for your project:'</span><span class="token punctuation">,</span>
        choices<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        pageSize<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        presetPrompt<span class="token punctuation">,</span>
        featurePrompt<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>这样配置后，在用户选择功能前会先弹出这样的提示语：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWcAAAA5CAIAAABlKX3pAAAIZklEQVR4nO2dTYwURRSAi91ZdnYZYRl+NuLCAhtNiPgDhCAxnESjiQknYky4GBPimYORAycPJB5IiAcTEvXgyYSDeFBM9KRxF8yuGJU/BYOEnwAz/C3s/O566KRS1s/rV9Xd1d3T7ztsuqtfv3pV0/Wq6lVv16Jbt+/Mz8/Pd7vtTqfT6bSazUaz+flnnx49epQRBEEo9KVtAEEQOYO8BkEQdpDXIAjCjpLpQt/Tb/m0gyCIvEBjDcITtVPH0jahN/FfseQ1CB/UTh1bsWN/2lb0Jit27PfsOIwzlIDqoZP8uP7h64BkY3qPlFLedkISkFIySFCK7NuZL0SXwZ/vIEU6JdwIHIe3OoS8RvXQSdFTSKcS5W0nJL/AT1WH0gOQf3FDer49P+7+CdxijxXQxwylvO1EXloX3tS8lMiZuHx9bzuFULyV3ec8JcRriDMUgmCMNab39OTgkcADzVDw0xNnxOdPmt2oiUzpAPlVkx5TjsF8Cplp6FX4xiiSqp2iBlVbaH1i5Hmi/1mY1Fuq0RCG673VcImYgjk25ctnHOpBFKuYIdBjOpX0eCYkGhqAdxn41suU+KgYBxGfYO0x+//DrdWjJWhs2ryAKAxgBrKwGCUYO/mpGjbC1CdGXnuXVUndkOYyvIWo6XBrkYKvwTFvdTxFbO1qOpAv/ys5DgxAQYJTIO5jqh//xBzXCOICEQMZ2p4QEIuShdhjm5Daj/PaELJcSDslZ4cnLxEZ545U25OrVyX9pnT1dkktMnCDj++IWQB3pRgtQo01ksPUfqTxeYB6GqonaWzz1ZYraXsyWG9apAYZpV91GAXYYqXZJGylBKgfz6C8RhIRjQBTBMHUH5pmImn1n/BgXsLDGysZrDertVXTAN6qhXhbtcEXTTvFYOZymcIloRMcG/PdCZ+hVA+d9LOSovZ7UgqyY8SImeb2WqS+Wvs+m1WnjRe2shO4N4pV6q+Q0AgF2fHi++eEBhrO75jAY59Qa7PzSv4i01d5Pv7mZiARuIzQ4QZmiUEVgEfO0gqCgx6TqfAailaPVEB4LQPIWi2XlZ1II5G3wPWmNdJtYQWI5JnCEKHycHYMDFhiMgXyNUUoTZZINmDWhlTNcP34nLCEe43eIxfvtrP82Imk4K972YKvLv8VW7j/Xgu6ykxFAbXkxU485DKQiMvAGPxXbMprKP7JS++dFzuJ2Mm+ey3cWAPPzgOH0zYhH1BFFQ3yGnp2Hjg8eeRg2lbkg8kjB8lxFArIa+TrUYjR2lRchq39WvmdBw6n8quR4ygUUFwjeBTc2k/wDCHvtRI23Z4QtrY5lCUWf0EQ3giZoTj3IVbNbPLIwSidVXA7oN9Km+QobX2Zg++D7beSt1XF4vNBNNwoDuFxDW9PA8URCCIXoFZe8VMVk38R07kenqiO6vklSdh0CmcacQYEKFHtRMpHt8dkIdPVpOj6reqfp4u3A6UmigD2fQ2M45AExIdSSg9O+eOoNi3xyebC0qMcOgIy6XeAK9HapuYSKh+XYSJS8+aJQYhUW6VaM7R2cmGxaDEaT+QI7Mqrz2UFtTNMHW4S3GnD8ikS428nFi0unUS+QI01orsMt2WCjDQ5AFs7M14cTl7sJFIh3GvEMsqwXYlMsR+zCuJ4WGFJBQc76b244hAyQ4n4vobtpSSURLlFvVdbIapmWB5pj+dXtjCRbIJg8H/KO7gMNdKuRs5M4QAg8q/eIl4C9EjarAoihQ+BNRG1sLC8ZCdcD6FOCtYjRWHgdRbATriSaaBRKIr4fQ0kWWgJWbAhlFwYScQI/feakdRbQl5aYy6MJGKEvEZ2odZIZBPyGgRB2EFegyAIO2LzGsHHDoPPKIvH3ohlo5oYyc536AkiXmL7bijw8fikIX+hNSD7n58kckovzFCCPXXx6WnZ44bDZoV8k2Gf+RLFoRe8BqGFxhpEQnja2cC065S6IZU0utaesghNQptdqELMzl34PcG08sDGXMgZByAfuuuyNlHUY/pd3PYWS2syS8SCD68hbgnDj4OHTL2kbpwtPsSqHlukTToxe3aadhu03Z4XkDdVEUatWDStvClfkwFaPabfhQuLavH5MsWDENkn5hmKthGa9tRklp0MoMcKkyeyNSMu1PYZr34TcdWnpC31+iSSxusMJa4QXXQ9VqjdrGQPnqwt6yRdn1q1QH0SucD3DCULepgywMbIa83IS7+qzdfDrsIm/Snuh05Ex+saikOHpr0lI++PuYmp8lLfm/TrJ6oeWHNcP4EUZCXyS2z/KS+OddWeXBoJm5ZOtKfaSL6ayDFN1+EYYWjRtHq0I21beemSapXtGgo+X219AvmaPF1ooRj6dyGyT3G/r0EDY4Jww1M0NFNYRTQIgpAootcgf0EUiuHy4g1rR89furZvz8vbN4+PrVrywUdfVFeP7d29+cvvztTvz+197fnxsTVTv8x8/ePFl7Zs2rVl/Kvvp4eGK4P93fLQ8A9T599/Z/f1K+cHFg99cvx0i5XpjXKC6HHee/uVd9/c/Or2tetWDY2vLD24V2s8rO3aurEy0H5hrK/xqF4dZrUbl+fn6ssrA/veeK5178rVS38+MVTasWnV1o2VkdLs2XMX1q2fuHqz3mx3Gf0fCkH0PBNrKhMb1i4bbHfazblGe2RkWZeVWp2FgYHSrfpsa770z9Ubg0uW3p1t33/c/Wny9Nm/b6xcM/Hk6Ir+voV/r9+Z6/SvXz9er91Z99RopbKUFXOGQhCF4vi3U8+MsqlfL8xcvD19ZumzG6qd1uPm7N3Tp34fHugudBq/nb08NXPu4aPWYP+Sn2f+ull79KDZf+3W3RfHy6urleXDCzN/XBrs3J6da/e1aoyNFHcNhSAIN/4D7seXzEyFP6cAAAAASUVORK5CYII=" alt="img"></p> <h3 id="包管理器"><a href="#包管理器" class="header-anchor">#</a> 包管理器</h3> <p>在 <code>vue-cli</code> 创建项目时，会生成一个 <code>.vuerc</code> 文件，里面会记录一些关于项目的配置信息。例如使用哪个包管理器、npm 源是否使用淘宝源等等。为了避免和 <code>vue-cli</code> 冲突，本脚手架生成的配置文件为 <code>.mvcrc</code>。</p> <p>这个 <code>.mvcrc</code> 文件保存在用户的 <code>home</code> 目录下（不同操作系统目录不同）。我的是 win10 操作系统，保存目录为 <code>C:\Users\bin</code>。获取用户的 <code>home</code> 目录可以通过以下代码获取：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span><span class="token function">homedir</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>.mvcrc</code> 文件还会保存用户创建项目的配置，这样当用户重新创建项目时，就可以直接选择以前创建过的配置，不用再一步步的选择项目功能。</p> <p>在第一次创建项目时，<code>.mvcrc</code> 文件是不存在的。如果这时用户还安装了 yarn，脚手架就会提示用户要使用哪个包管理器：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 读取 `.mvcrc` 文件</span>
<span class="token keyword">const</span> savedOptions <span class="token operator">=</span> <span class="token function">loadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 如果没有指定包管理器并且存在 yarn</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>savedOptions<span class="token punctuation">.</span>packageManager <span class="token operator">&amp;&amp;</span> hasYarn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> packageManagerChoices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasYarn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        packageManagerChoices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'Use Yarn'</span><span class="token punctuation">,</span>
            value<span class="token operator">:</span> <span class="token string">'yarn'</span><span class="token punctuation">,</span>
            short<span class="token operator">:</span> <span class="token string">'Yarn'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    packageManagerChoices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'Use NPM'</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span> <span class="token string">'npm'</span><span class="token punctuation">,</span>
        short<span class="token operator">:</span> <span class="token string">'NPM'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    otherPrompts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'packageManager'</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'Pick the package manager to use when installing dependencies:'</span><span class="token punctuation">,</span>
        choices<span class="token operator">:</span> packageManagerChoices<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><img src="data:image/png;base64,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" alt="img"></p> <p>当用户选择 yarn 后，下载依赖的命令就会变为 <code>yarn</code>；如果选择了 npm，下载命令则为 <code>npm install</code>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PACKAGE_MANAGER_CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    npm<span class="token operator">:</span> <span class="token punctuation">{</span>
        install<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'install'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    yarn<span class="token operator">:</span> <span class="token punctuation">{</span>
        install<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">await</span> <span class="token function">executeCommand</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bin<span class="token punctuation">,</span> <span class="token comment">// 'yarn' or 'npm'</span>
    <span class="token punctuation">[</span>
        <span class="token operator">...</span><span class="token constant">PACKAGE_MANAGER_CONFIG</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>bin<span class="token punctuation">]</span><span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token operator">...</span><span class="token punctuation">(</span>args <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span>
<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="切换-npm-源"><a href="#切换-npm-源" class="header-anchor">#</a> 切换 npm 源</h3> <p>当用户选择了项目功能后，会先调用 <code>shouldUseTaobao()</code> 方法判断是否需要切换淘宝源：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> execa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'execa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./request'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> hasYarn <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./env'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'inquirer'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> registries <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./registries'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> loadOptions<span class="token punctuation">,</span> saveOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./options'</span><span class="token punctuation">)</span>
  
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">ping</span><span class="token punctuation">(</span><span class="token parameter">registry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>registry<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/vue-cli-version-marker/latest</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> registry
<span class="token punctuation">}</span>
  
<span class="token keyword">function</span> <span class="token function">removeSlash</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
  
<span class="token keyword">let</span> checked
<span class="token keyword">let</span> result
  
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">shouldUseTaobao</span><span class="token punctuation">(</span><span class="token parameter">command</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        command <span class="token operator">=</span> <span class="token function">hasYarn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'yarn'</span> <span class="token operator">:</span> <span class="token string">'npm'</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// ensure this only gets called once.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>checked<span class="token punctuation">)</span> <span class="token keyword">return</span> result
    checked <span class="token operator">=</span> <span class="token boolean">true</span>
  
    <span class="token comment">// previously saved preference</span>
    <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token function">loadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>useTaobaoRegistry
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> saved <span class="token operator">===</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>result <span class="token operator">=</span> saved<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">const</span> <span class="token function-variable function">save</span> <span class="token operator">=</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> val
        <span class="token function">saveOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> useTaobaoRegistry<span class="token operator">:</span> val <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> val
    <span class="token punctuation">}</span>
  
    <span class="token keyword">let</span> userCurrent
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        userCurrent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'registry'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>stdout
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>registryError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Yarn 2 uses `npmRegistryServer` instead of `registry`</span>
            userCurrent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'npmRegistryServer'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>stdout
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>npmRegistryServerError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">const</span> defaultRegistry <span class="token operator">=</span> registries<span class="token punctuation">[</span>command<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">removeSlash</span><span class="token punctuation">(</span>userCurrent<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token function">removeSlash</span><span class="token punctuation">(</span>defaultRegistry<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// user has configured custom registry, respect that</span>
        <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">let</span> faster
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        faster <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token function">ping</span><span class="token punctuation">(</span>defaultRegistry<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">ping</span><span class="token punctuation">(</span>registries<span class="token punctuation">.</span>taobao<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">if</span> <span class="token punctuation">(</span>faster <span class="token operator">!==</span> registries<span class="token punctuation">.</span>taobao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// default is already faster</span>
        <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_CLI_API_MODE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// ask and save preference</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> useTaobaoRegistry <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'useTaobaoRegistry'</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
            message<span class="token operator">:</span> chalk<span class="token punctuation">.</span><span class="token function">yellow</span><span class="token punctuation">(</span>
                <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> Your connection to the default </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>command<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> registry seems to be slow.\n</span><span class="token template-punctuation string">`</span></span>
            <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">   Use </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">cyan</span><span class="token punctuation">(</span>registries<span class="token punctuation">.</span>taobao<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> for faster installation?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 注册淘宝源</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>useTaobaoRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'set'</span><span class="token punctuation">,</span> <span class="token string">'registry'</span><span class="token punctuation">,</span> registries<span class="token punctuation">.</span>taobao<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">save</span><span class="token punctuation">(</span>useTaobaoRegistry<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><p>上面代码的逻辑为：</p> <ol><li>先判断默认配置文件 <code>.mvcrc</code> 是否有 <code>useTaobaoRegistry</code> 选项。如果有，直接将结果返回，无需判断。</li> <li>向 npm 默认源和淘宝源各发一个 <code>get</code> 请求，通过 <code>Promise.race()</code> 来调用。这样更快的那个请求会先返回，从而知道是默认源还是淘宝源速度更快。</li> <li>如果淘宝源速度更快，向用户提示是否切换到淘宝源。</li> <li>如果用户选择淘宝源，则调用 <code>await execa(command, ['config', 'set', 'registry', registries.taobao])</code> 将当前 npm 的源改为淘宝源，即 <code>npm config set registry https://registry.npm.taobao.org</code>。如果是 yarn，则命令为 <code>yarn config set registry https://registry.npm.taobao.org</code>。</li></ol> <h4 id="一点疑问"><a href="#一点疑问" class="header-anchor">#</a> 一点疑问</h4> <p>其实 <code>vue-cli</code> 是没有这段代码的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注册淘宝源</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>useTaobaoRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'set'</span><span class="token punctuation">,</span> <span class="token string">'registry'</span><span class="token punctuation">,</span> registries<span class="token punctuation">.</span>taobao<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这是我自己加的。主要是我没有在 <code>vue-cli</code> 中找到显式注册淘宝源的代码，它只是从配置文件读取出是否使用淘宝源，或者将是否使用淘宝源这个选项写入配置文件。另外 npm 的配置文件 <code>.npmrc</code> 是可以更改默认源的，如果在 <code>.npmrc</code> 文件直接写入淘宝的镜像地址，那 npm 就会使用淘宝源下载依赖。但 npm 肯定不会去读取 <code>.vuerc</code> 的配置来决定是否使用淘宝源。</p> <p>对于这一点我没搞明白，所以在用户选择了淘宝源之后，手动调用命令注册一遍。</p> <h3 id="将项目功能保存为默认配置"><a href="#将项目功能保存为默认配置" class="header-anchor">#</a> 将项目功能保存为默认配置</h3> <p>如果用户创建项目时选择手动模式，在选择完一系列功能后，会弹出下面的提示语：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAb8AAAAUCAIAAACS3aS8AAAFXklEQVR4nO2av0/jSBTHnx2jIH6KIyzSiYISCSGEhAQVSigo+AMWJDqquxLR3HURfwZIlFQ0lCCIQrMIxAkJKXeBioSQgjiKEnIbzoDnCm/MrO2ZzNgmdnbnIxT5x8ybN+/NfD1jA+V/X9Xm39f/3tZ+/wMEAoFA0ApFkqRvhwhAopYVCAQCQRPl5Q0BSAghAIhGhHwKBAIBE8pDDQEghEAC+HUgaHcEAoGgQ1DKX3VDOhGgX3oiQfsjEAgEnYGi6wAAOiAAQOblJFYkCS0xNv4G7y9SA8J0huSJUSBwP39sWmYh5PbDSZuHrut5nU6nASAej7to1FIXP/Vi9iOQvzszYpVs/iaxUzJmRo344hFvA/bmfqrp1Da40opP8o8YDy7st3lYhhb2OLie1641zqhIAdfQMCADADIWnmZwkkzrzTDgbkqYA0LAiGvp+ehQM9r/YaTTYzy54uCuLb+kkySRoRJQ2SqdOEnslw1LxBGG5aL9mFSehMWIYxVG+1zttsEOpTDY+oufeuyv43WWODNCsk/y34Vxx2NH/+nHXPGk++M9X6RbpPKkwo5xaNkvxPy6gCSd6XTa1Dv8mF4x/AIqg2fpNBf29tBLTYDhuWcmibG8mU68FYtBiylSMa52Sf3yyw6lsNkpvAqpRyR/eK+3jLNj6+AkDXT7dgtc9knw+s8bT7od7/nCnbfX8p5Hervs0ukaynI1DBJJQfZlT0MJPeMQt1TxwSfmlFtGNkstx375Zcc15tPC3gS7n979scxS9oqO/vtonxfGePpr34URij/sTwuucesjJOkMz6chCu9fjawZSLLu2c380Z+BjEgY7LU8YjTHODEo/fLLjjsMOxaDjvGk+BlI/M2mIYgJTII9nj7ad2HEuz8txwOjHd49Nf0lKel6eL68f1NPh7me/KhvR6bIUjYF7VyxktQ/KDsfAR4fFj9J8fRx5RUIfvkftjjw5ot9PPD21FFAzYu8/37k+Aq1Za22oYApnchJQxmwPLXwjRWeGOPYfN7apZNkh7Fpszwl2fgtfOnH1S6pX37ZodfCeyHZFvss8eS9bneV0T1Gf0jlvdh3HG8W/0nlef1nd9hdvkhh9yuPrvtFIh6PG0KJaxxFVdnhkk76RydfUMwjh507M6SIWzLXsoqLzDmOKkYfXLdLsumXHfZa9Iq8/XVhyrsRL0Gj3OIdb7iauGiagvd88Zb3MQXuukz5BGTeYtyw2yU4PCjmwvP9VxBKeNdogmDxK1++rw3bDL4GDJv8eURB6LsNrdDP0NJx0+Ynx8d8dXTqg1XMvr4+TdN0XR8cHJRlWdO0zc3N3d3d5eXl2dnZVCp1dHS0sbFRrVYXFxdPT0/39vaGhoZWVlYikcjFxUUmk1ldXT04OEgkEtvb21tbW41GQ1VVANjZ2ZERQnrzD3/ECQQCQecSj8f39/cPDw+Pj4/X19evrq6ur68fHh7u7+9jsVgikeju7p6fn+/p6Xl5eRkdHc3n8wMDA5qmra2tTU1NaZp2c3MDAJOTk3NzczMzM9FoNJ/PVyqViYmJk5MTAFAQ0nUdIQAESIcIQnrQvRYIBAIfmJ6eVhSlv7+/q6sLABqNRiwWGx4eLhaLvb29tVqtXC5Xq9V6vV4oFJaWlrLZbL1eNxT26elpfHy8VCrFYrFarZbL5RRFGRkZkWVZVdWFhYW7u7vI59/+1BF60990hD71RU5Sqb//+hJ0rwUCgcArqqoihFKp1D9NXl9fz87OJEkaGxvLZDLRaPT29rbRaFSr1cvLy0KhUK/Xn5+fVVU9Pz8vlUrFYjGfzyuKAgCPj4+1Wk2SpGw2W6lUcrnc//pl6fw0FBH+AAAAAElFTkSuQmCC" alt="img">询问用户是否将这次的项目选择保存为默认配置，如果用户选择是，则弹出下一个提示语：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMUAAAAgCAIAAAAt0yuWAAAEGElEQVR4nO2cvW7jRhCAZ3ZHlO4VrnFpwHDqII2hKp1bd34TCxCQMg8Q4IB0QXzdBUnhOJUqN4YbF7ZrN64dILEoaWZSUF6vSYpcUrIl5fYrCHJ2Z3ZIDfefwp9+v0I0gAgA3+19PDk5+ePXTwAAQ3g51qGq7hwRi3JEzM5dau6y2k5I0TnLTuIX5Nsv5gkvd9F9rcpObf5A52t/l0A5lD3nUigdPyEgGARAns2EeZ4yrNDKs6gMX57LU6oSGEPVKhUFhfjZtNAQ+03thGtVKza93xamctAkTdGY7EKEmWchapH3x9UQqtrixXsfaDabZsGngMIsIut2KVLOxsaQD4kwAGgWUqoa4ymyBKSqoACoIjg/j0TaQgAIWT2KMZQiy0LGEoCCgoIgPsdWJNIKok4HREUFwCDifKw39LIMSxVf0WLeKLJyRqNRdtLv99flg0mShJJOp5MQJcYYg+ZlJtOdVOIm4hbNGf4v2cDbXGMYOaiT9IRZRAEUjTXWNJrJ/Dp5h2AKnI/eNChJeiysIqJqrDWGXhKH3jGMkPn+4gJFcamkaKqI0y1dYPGTau03kvvzio1cDS+3Ka6lq5C72quYuTSpXW1nkt6HbreXdHtJt2stWbLzlKF3rMT9iqWrY+HtYNN202XLqRR/mEy+yH5TubPv312tq+H2mxrPgqDf7+ciICfPhVEm9JOq8wdClCTCVlVU1VprLdUrFfBDatH7F8gKm5LMmZzB0qB3ni+KxeU9KQqry10V7cKiNdRJEhFREVCw1hr7un4KwH/P/JCqXthfxAqfbGYqfB26tHpb3p+K51BR7qr6T+/cSSeijqqqKKiiscY0bu+a4sLOXRbzhGzeWIbSPlzufQjxZxk/Q8pdFa4teyP7DmMsZc2cJTLGmOe9BuHk+k9+9wJeN4KlXZBaO7XkVIr95XA/Q+RQWa8UWfQcqu83vP/kujuj0cjv+vhyKAumnKQ2fwj42/XfKpDd4zcfu4PB4POnH1sYWgtvXY1FmkLKCgAKmzc9V4dfD8WQ2hCIeeYiSVRUt2a/SoyhDYSmkzR7u1VBOcm2Q0Ui7aDxeJwNqwGU+QPP4n7fSHsoHf+DOB/TMU+ZY/0UaQ+Nn/5FRAAEAJ4xz6brdimyxVD69ITP2+iYp/H7lsgy0CQde/HEwlszvotsIMTTCczjCZUlju8iy0DM7JZNBWSFy/uRrxBSlWyyQAFBFeIHU5ElIDQGAXT+1dR8oBeJOI6OjtI0PT4+Pj093d3dvbi4ODw8PDs729/fv7293dnZubu7Ozg4OD8/v7y8NNZYtGSstca+6cauyJayt7dHRNfX15PJxFqbpunV1dXj4+PNzc39/X32BwUPDw/T6RQA8Ief/3Sa33+7OxgM/vryy9p8j2w5/wHSlMPXfw4u4QAAAABJRU5ErkJggg==" alt="img"></p> <p>让用户输入保存配置的名称。</p> <p>这两句提示语相关的代码为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> otherPrompts <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'save'</span><span class="token punctuation">,</span>
        when<span class="token operator">:</span> isManualMode<span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'Save this as a preset for future projects?'</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'saveName'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">when</span><span class="token operator">:</span> <span class="token parameter">answers</span> <span class="token operator">=&gt;</span> answers<span class="token punctuation">.</span>save<span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'Save preset as:'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>保存配置的代码为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>exports<span class="token punctuation">.</span><span class="token function-variable function">saveOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">toSave</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>exports<span class="token punctuation">.</span><span class="token function">loadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> toSave<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> exports<span class="token punctuation">.</span>defaults<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> options<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    cachedOptions <span class="token operator">=</span> options
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>rcPath<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error saving preferences: </span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">make sure you have write access to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\n</span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">savePreset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> preset</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> presets <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>exports<span class="token punctuation">.</span><span class="token function">loadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>presets <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    presets<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> preset

    <span class="token keyword">return</span> exports<span class="token punctuation">.</span><span class="token function">saveOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> presets <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>以上代码直接将用户的配置保存到 <code>.mvcrc</code> 文件中。下面是我电脑上的 <code>.mvcrc</code> 的内容：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;packageManager&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;linter&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lintOn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;save&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;demo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;linter&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lintOn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;save&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;useTaobaoRegistry&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>下次再创建项目时，脚手架就会先读取这个配置文件的内容，让用户决定是否使用已有的配置来创建项目。</p> <p>至此，v2 版本的内容就介绍完了。</p> <h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p>由于 <code>vue-cli</code> 关于插件的源码我还没有看完，所以这篇文章只讲解前两个版本的源码。v3 版本等我看完 <code>vue-cli</code> 的源码再回来填坑，预计在 3 月初就可以完成。</p> <p>如果你想了解更多关于前端工程化的文章，可以看一下我写的<a href="https://github.com/woai3c/introduction-to-front-end-engineering" target="_blank" rel="noopener noreferrer">《带你入门前端工程》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。 这里是全文目录：</p> <ol><li>技术选型：如何进行技术选型？</li> <li>统一规范：如何制订规范并利用工具保证规范被严格执行？</li> <li>前端组件化：什么是模块化、组件化？</li> <li>测试：如何写单元测试和 E2E（端到端） 测试？</li> <li>构建工具：构建工具有哪些？都有哪些功能和优势？</li> <li>自动化部署：如何利用 Jenkins、Github Actions 自动化部署项目？</li> <li>前端监控：讲解前端监控原理及如何利用 sentry 对项目实行监控。</li> <li>性能优化（一）：如何检测网站性能？有哪些实用的性能优化规则？</li> <li>性能优化（二）：如何检测网站性能？有哪些实用的性能优化规则？</li> <li>重构：为什么做重构？重构有哪些手法？</li> <li>微服务：微服务是什么？如何搭建微服务项目？</li> <li>Severless：Severless 是什么？如何使用 Severless？</li></ol> <h2 id="参考链接"><a href="#参考链接" class="header-anchor">#</a> 参考链接</h2> <p>https://github.com/woai3c/mini-cli</p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/06/25, 15:41:34</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/rat-summ/pages/41364d/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">vue-cli实践使用</div></a> <a href="/rat-summ/pages/71132c/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">vue-cli源码分析</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/rat-summ/pages/41364d/" class="prev">vue-cli实践使用</a></span> <span class="next"><a href="/rat-summ/pages/71132c/">vue-cli源码分析</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:yessz@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/samyzh" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
    Copyright © 2015-2021
    <span><a href='https://my.samyz.cn' target='_blank'>友一升 | yessz</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;width:160px;height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/rat-summ/assets/js/app.d4fe6087.js" defer></script><script src="/rat-summ/assets/js/2.d4f28c34.js" defer></script><script src="/rat-summ/assets/js/16.4204b333.js" defer></script><script src="/rat-summ/assets/js/96.e18c84a7.js" defer></script>
  </body>
</html>